var test=(()=>{var gl=Object.create;var Fr=Object.defineProperty;var vl=Object.getOwnPropertyDescriptor;var Dl=Object.getOwnPropertyNames;var El=Object.getPrototypeOf,_l=Object.prototype.hasOwnProperty;var ws=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var O=(e,t)=>()=>(e&&(t=e(e=0)),t);var M=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),H=(e,t)=>{for(var r in t)Fr(e,r,{get:t[r],enumerable:!0})},gs=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Dl(t))!_l.call(e,o)&&o!==r&&Fr(e,o,{get:()=>t[o],enumerable:!(n=vl(t,o))||n.enumerable});return e};var De=(e,t,r)=>(r=e!=null?gl(El(e)):{},gs(t||!e||!e.__esModule?Fr(r,"default",{value:e,enumerable:!0}):r,e)),Lr=e=>gs(Fr({},"__esModule",{value:!0}),e);function Es(e,t,r){t=t||[],r=r||0;for(var n=r;e>=Tl;)t[r++]=e&255|vs,e/=128;for(;e&Cl;)t[r++]=e&255|vs,e>>>=7;return t[r]=e|0,Es.bytes=r-n+1,t}function ao(e,n){var r=0,n=n||0,o=0,i=n,s,a=e.length;do{if(i>=a)throw ao.bytes=0,new RangeError("Could not decode varint");s=e[i++],r+=o<28?(s&Ds)<<o:(s&Ds)*Math.pow(2,o),o+=7}while(s>=Il);return ao.bytes=i-n,r}var Sl,vs,Al,Cl,Tl,kl,Il,Ds,Ol,Ul,Rl,Pl,Bl,Nl,Ml,Fl,Ll,jl,$l,zl,nr,_s=O(()=>{Sl=Es,vs=128,Al=127,Cl=~Al,Tl=Math.pow(2,31);kl=ao,Il=128,Ds=127;Ol=Math.pow(2,7),Ul=Math.pow(2,14),Rl=Math.pow(2,21),Pl=Math.pow(2,28),Bl=Math.pow(2,35),Nl=Math.pow(2,42),Ml=Math.pow(2,49),Fl=Math.pow(2,56),Ll=Math.pow(2,63),jl=function(e){return e<Ol?1:e<Ul?2:e<Rl?3:e<Pl?4:e<Bl?5:e<Nl?6:e<Ml?7:e<Fl?8:e<Ll?9:10},$l={encode:Sl,decode:kl,encodingLength:jl},zl=$l,nr=zl});var or,Dt,Et,$r=O(()=>{_s();or=(e,t=0)=>[nr.decode(e,t),nr.decode.bytes],Dt=(e,t,r=0)=>(nr.encode(e,t,r),t),Et=e=>nr.encodingLength(e)});var s0,Ss,Be,As,Cs,Ye=O(()=>{s0=new Uint8Array(0),Ss=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},Be=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},As=e=>new TextEncoder().encode(e),Cs=e=>new TextDecoder().decode(e)});var Ne,zr,Ts,_t,nt=O(()=>{Ye();$r();Ne=(e,t)=>{let r=t.byteLength,n=Et(e),o=n+Et(r),i=new Uint8Array(o+r);return Dt(e,i,0),Dt(r,i,n),i.set(t,o),new _t(e,r,t,i)},zr=e=>{let t=Be(e),[r,n]=or(t),[o,i]=or(t.subarray(n)),s=t.subarray(n+i);if(s.byteLength!==o)throw new Error("Incorrect length");return new _t(r,o,s,t)},Ts=(e,t)=>e===t?!0:e.code===t.code&&e.size===t.size&&Ss(e.bytes,t.bytes),_t=class{constructor(t,r,n,o){this.code=t,this.size=r,this.digest=n,this.bytes=o}}});function ql(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<e.length;o++){var i=e.charAt(o),s=i.charCodeAt(0);if(r[s]!==255)throw new TypeError(i+" is ambiguous");r[s]=o}var a=e.length,c=e.charAt(0),u=Math.log(a)/Math.log(256),d=Math.log(256)/Math.log(a);function w(y){if(y instanceof Uint8Array||(ArrayBuffer.isView(y)?y=new Uint8Array(y.buffer,y.byteOffset,y.byteLength):Array.isArray(y)&&(y=Uint8Array.from(y))),!(y instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(y.length===0)return"";for(var v=0,L=0,k=0,U=y.length;k!==U&&y[k]===0;)k++,v++;for(var j=(U-k)*d+1>>>0,I=new Uint8Array(j);k!==U;){for(var J=y[k],z=0,C=j-1;(J!==0||z<L)&&C!==-1;C--,z++)J+=256*I[C]>>>0,I[C]=J%a>>>0,J=J/a>>>0;if(J!==0)throw new Error("Non-zero carry");L=z,k++}for(var te=j-L;te!==j&&I[te]===0;)te++;for(var We=c.repeat(v);te<j;++te)We+=e.charAt(I[te]);return We}function x(y){if(typeof y!="string")throw new TypeError("Expected String");if(y.length===0)return new Uint8Array;var v=0;if(y[v]!==" "){for(var L=0,k=0;y[v]===c;)L++,v++;for(var U=(y.length-v)*u+1>>>0,j=new Uint8Array(U);y[v];){var I=r[y.charCodeAt(v)];if(I===255)return;for(var J=0,z=U-1;(I!==0||J<k)&&z!==-1;z--,J++)I+=a*j[z]>>>0,j[z]=I%256>>>0,I=I/256>>>0;if(I!==0)throw new Error("Non-zero carry");k=J,v++}if(y[v]!==" "){for(var C=U-k;C!==U&&j[C]===0;)C++;for(var te=new Uint8Array(L+(U-C)),We=L;C!==U;)te[We++]=j[C++];return te}}}function h(y){var v=x(y);if(v)return v;throw new Error(`Non-${t} character`)}return{encode:w,decodeUnsafe:x,decode:h}}var Gl,Jl,ks,Is=O(()=>{Gl=ql,Jl=Gl,ks=Jl});var uo,fo,lo,Os,po,St,Ke,Hl,Vl,q,Ee=O(()=>{Is();Ye();uo=class{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},fo=class{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Os(this,t)}},lo=class{constructor(t){this.decoders=t}or(t){return Os(this,t)}decode(t){let r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Os=(e,t)=>new lo({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}}),po=class{constructor(t,r,n,o){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new uo(t,r,n),this.decoder=new fo(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}},St=({name:e,prefix:t,encode:r,decode:n})=>new po(e,t,r,n),Ke=({prefix:e,name:t,alphabet:r})=>{let{encode:n,decode:o}=ks(r,t);return St({prefix:e,name:t,encode:n,decode:i=>Be(o(i))})},Hl=(e,t,r,n)=>{let o={};for(let d=0;d<t.length;++d)o[t[d]]=d;let i=e.length;for(;e[i-1]==="=";)--i;let s=new Uint8Array(i*r/8|0),a=0,c=0,u=0;for(let d=0;d<i;++d){let w=o[e[d]];if(w===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|w,a+=r,a>=8&&(a-=8,s[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s},Vl=(e,t,r)=>{let n=t[t.length-1]==="=",o=(1<<r)-1,i="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>r;)s-=r,i+=t[o&a>>s];if(s&&(i+=t[o&a<<r-s]),n)for(;i.length*r&7;)i+="=";return i},q=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>St({prefix:t,name:e,encode(o){return Vl(o,n,r)},decode(o){return Hl(o,n,r,e)}})});var mo={};H(mo,{base58btc:()=>Ie,base58flickr:()=>Wl});var Ie,Wl,ho=O(()=>{Ee();Ie=Ke({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Wl=Ke({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});var bo={};H(bo,{base32:()=>At,base32hex:()=>Zl,base32hexpad:()=>ed,base32hexpadupper:()=>td,base32hexupper:()=>Ql,base32pad:()=>Kl,base32padupper:()=>Xl,base32upper:()=>Yl,base32z:()=>rd});var At,Yl,Kl,Xl,Zl,Ql,ed,td,rd,yo=O(()=>{Ee();At=q({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Yl=q({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Kl=q({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Xl=q({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Zl=q({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Ql=q({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),ed=q({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),td=q({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),rd=q({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})});var g,nd,od,id,sr,sd,Us,Rs,qr,Gr,ad,cd,ud,Me=O(()=>{$r();nt();ho();yo();Ye();g=class{constructor(t,r,n,o){this.code=r,this.version=t,this.multihash=n,this.bytes=o,this.byteOffset=o.byteOffset,this.byteLength=o.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:Gr,byteLength:Gr,code:qr,version:qr,multihash:qr,bytes:qr,_baseCache:Gr,asCID:Gr})}toV0(){switch(this.version){case 0:return this;default:{let{code:t,multihash:r}=this;if(t!==sr)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==sd)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return g.createV0(r)}}}toV1(){switch(this.version){case 0:{let{code:t,digest:r}=this.multihash,n=Ne(t,r);return g.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(t){return t&&this.code===t.code&&this.version===t.version&&Ts(this.multihash,t.multihash)}toString(t){let{bytes:r,version:n,_baseCache:o}=this;switch(n){case 0:return od(r,o,t||Ie.encoder);default:return id(r,o,t||At.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(t){return cd(/^0\.0/,ud),!!(t&&(t[Rs]||t.asCID===t))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(t){if(t instanceof g)return t;if(t!=null&&t.asCID===t){let{version:r,code:n,multihash:o,bytes:i}=t;return new g(r,n,o,i||Us(r,n,o.bytes))}else if(t!=null&&t[Rs]===!0){let{version:r,multihash:n,code:o}=t,i=zr(n);return g.create(r,o,i)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");switch(t){case 0:{if(r!==sr)throw new Error(`Version 0 CID must use dag-pb (code: ${sr}) block encoding`);return new g(t,r,n,n.bytes)}case 1:{let o=Us(t,r,n.bytes);return new g(t,r,n,o)}default:throw new Error("Invalid version")}}static createV0(t){return g.create(0,sr,t)}static createV1(t,r){return g.create(1,t,r)}static decode(t){let[r,n]=g.decodeFirst(t);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(t){let r=g.inspectBytes(t),n=r.size-r.multihashSize,o=Be(t.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");let i=o.subarray(r.multihashSize-r.digestSize),s=new _t(r.multihashCode,r.digestSize,i,o);return[r.version===0?g.createV0(s):g.createV1(r.codec,s),t.subarray(r.size)]}static inspectBytes(t){let r=0,n=()=>{let[w,x]=or(t.subarray(r));return r+=x,w},o=n(),i=sr;if(o===18?(o=0,r=0):o===1&&(i=n()),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let s=r,a=n(),c=n(),u=r+c,d=u-s;return{version:o,codec:i,multihashCode:a,digestSize:c,multihashSize:d,size:u}}static parse(t,r){let[n,o]=nd(t,r),i=g.decode(o);return i._baseCache.set(n,t),i}},nd=(e,t)=>{switch(e[0]){case"Q":{let r=t||Ie;return[Ie.prefix,r.decode(`${Ie.prefix}${e}`)]}case Ie.prefix:{let r=t||Ie;return[Ie.prefix,r.decode(e)]}case At.prefix:{let r=t||At;return[At.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}},od=(e,t,r)=>{let{prefix:n}=r;if(n!==Ie.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let o=t.get(n);if(o==null){let i=r.encode(e).slice(1);return t.set(n,i),i}else return o},id=(e,t,r)=>{let{prefix:n}=r,o=t.get(n);if(o==null){let i=r.encode(e);return t.set(n,i),i}else return o},sr=112,sd=18,Us=(e,t,r)=>{let n=Et(e),o=n+Et(t),i=new Uint8Array(o+r.byteLength);return Dt(e,i,0),Dt(t,i,n),i.set(r,o),i},Rs=Symbol.for("@ipld/js-cid/CID"),qr={writable:!1,configurable:!1,enumerable:!0},Gr={writable:!1,enumerable:!1,configurable:!1},ad="0.0.0-dev",cd=(e,t)=>{if(e.test(ad))console.warn(t);else throw new Error(t)},ud=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`});var xo={};H(xo,{base36:()=>_e,base36upper:()=>fd});var _e,fd,Ct=O(()=>{Ee();_e=Ke({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),fd=Ke({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})});var Ms=M((g0,Ns)=>{Ns.exports=wo;var Bs=128,pd=127,md=~pd,hd=Math.pow(2,31);function wo(e,t,r){if(Number.MAX_SAFE_INTEGER&&e>Number.MAX_SAFE_INTEGER)throw wo.bytes=0,new RangeError("Could not encode varint");t=t||[],r=r||0;for(var n=r;e>=hd;)t[r++]=e&255|Bs,e/=128;for(;e&md;)t[r++]=e&255|Bs,e>>>=7;return t[r]=e|0,wo.bytes=r-n+1,t}});var js=M((v0,Ls)=>{Ls.exports=go;var bd=128,Fs=127;function go(e,n){var r=0,n=n||0,o=0,i=n,s,a=e.length;do{if(i>=a||o>49)throw go.bytes=0,new RangeError("Could not decode varint");s=e[i++],r+=o<28?(s&Fs)<<o:(s&Fs)*Math.pow(2,o),o+=7}while(s>=bd);return go.bytes=i-n,r}});var zs=M((D0,$s)=>{var yd=Math.pow(2,7),xd=Math.pow(2,14),wd=Math.pow(2,21),gd=Math.pow(2,28),vd=Math.pow(2,35),Dd=Math.pow(2,42),Ed=Math.pow(2,49),_d=Math.pow(2,56),Sd=Math.pow(2,63);$s.exports=function(e){return e<yd?1:e<xd?2:e<wd?3:e<gd?4:e<vd?5:e<Dd?6:e<Ed?7:e<_d?8:e<Sd?9:10}});var Jr=M((E0,qs)=>{qs.exports={encode:Ms(),decode:js(),encodingLength:zs()}});function ot(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}var ar=O(()=>{});function cr(e=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?ot(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}var Hr=O(()=>{ar()});var Gs={};H(Gs,{concat:()=>Tt});function Tt(e,t){t||(t=e.reduce((o,i)=>o+i.length,0));let r=cr(t),n=0;for(let o of e)r.set(o,n),n+=o.length;return ot(r)}var vo=O(()=>{Hr();ar()});var Do={};H(Do,{identity:()=>Ad});var Ad,Js=O(()=>{Ee();Ye();Ad=St({prefix:"\0",name:"identity",encode:e=>Cs(e),decode:e=>As(e)})});var Eo={};H(Eo,{base2:()=>Cd});var Cd,Hs=O(()=>{Ee();Cd=q({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})});var _o={};H(_o,{base8:()=>Td});var Td,Vs=O(()=>{Ee();Td=q({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})});var So={};H(So,{base10:()=>kd});var kd,Ws=O(()=>{Ee();kd=Ke({prefix:"9",name:"base10",alphabet:"0123456789"})});var Ao={};H(Ao,{base16:()=>Id,base16upper:()=>Od});var Id,Od,Ys=O(()=>{Ee();Id=q({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Od=q({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});var Co={};H(Co,{base64:()=>Ud,base64pad:()=>Rd,base64url:()=>Pd,base64urlpad:()=>Bd});var Ud,Rd,Pd,Bd,Ks=O(()=>{Ee();Ud=q({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Rd=q({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Pd=q({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Bd=q({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});var To={};H(To,{base256emoji:()=>jd});function Fd(e){return e.reduce((t,r)=>(t+=Nd[r],t),"")}function Ld(e){let t=[];for(let r of e){let n=Md[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}var Xs,Nd,Md,jd,Zs=O(()=>{Ee();Xs=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Nd=Xs.reduce((e,t,r)=>(e[r]=t,e),[]),Md=Xs.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);jd=St({prefix:"\u{1F680}",name:"base256emoji",encode:Fd,decode:Ld})});var Io,ko,Oo=O(()=>{nt();Io=({name:e,code:t,encode:r})=>new ko(e,t,r),ko=class{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){let r=this.encode(t);return r instanceof Uint8Array?Ne(this.code,r):r.then(n=>Ne(this.code,n))}else throw Error("Unknown type, must be binary type")}}});var Ro={};H(Ro,{sha256:()=>Uo,sha512:()=>$d});var ea,Uo,$d,Po=O(()=>{Oo();ea=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Uo=Io({name:"sha2-256",code:18,encode:ea("SHA-256")}),$d=Io({name:"sha2-512",code:19,encode:ea("SHA-512")})});var Bo={};H(Bo,{identity:()=>Gd});var ta,zd,ra,qd,Gd,na=O(()=>{Ye();nt();ta=0,zd="identity",ra=Be,qd=e=>Ne(ta,ra(e)),Gd={code:ta,name:zd,encode:ra,digest:qd}});var oa=O(()=>{Ye()});var z0,q0,ia=O(()=>{z0=new TextEncoder,q0=new TextDecoder});var No=O(()=>{Me();$r();Ye();Oo();nt()});var Mo,V0,sa=O(()=>{Js();Hs();Vs();Ws();Ys();yo();Ct();ho();Ks();Zs();Po();na();oa();ia();No();Mo={...Do,...Eo,..._o,...So,...Ao,...bo,...xo,...mo,...Co,...To},V0={...Ro,...Bo}});function ca(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}var aa,Fo,Vd,Vr,Lo=O(()=>{sa();Hr();aa=ca("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),Fo=ca("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);let t=cr(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),Vd={utf8:aa,"utf-8":aa,hex:Mo.base16,latin1:Fo,ascii:Fo,binary:Fo,...Mo},Vr=Vd});var ua={};H(ua,{fromString:()=>it});function it(e,t="utf8"){let r=Vr[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?ot(globalThis.Buffer.from(e,"utf-8")):r.decoder.decode(`${r.prefix}${e}`)}var jo=O(()=>{Lo();ar()});var fa={};H(fa,{toString:()=>Fe});function Fe(e,t="utf8"){let r=Vr[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}var $o=O(()=>{Lo()});var Ar=M((Er,Jt)=>{var pm=200,vu="__lodash_hash_undefined__",Du=9007199254740991,Bi="[object Arguments]",mm="[object Array]",Eu="[object Boolean]",_u="[object Date]",hm="[object Error]",Ni="[object Function]",Su="[object GeneratorFunction]",Tn="[object Map]",Au="[object Number]",Mi="[object Object]",fu="[object Promise]",Cu="[object RegExp]",kn="[object Set]",Tu="[object String]",ku="[object Symbol]",ki="[object WeakMap]",Iu="[object ArrayBuffer]",In="[object DataView]",Ou="[object Float32Array]",Uu="[object Float64Array]",Ru="[object Int8Array]",Pu="[object Int16Array]",Bu="[object Int32Array]",Nu="[object Uint8Array]",Mu="[object Uint8ClampedArray]",Fu="[object Uint16Array]",Lu="[object Uint32Array]",bm=/[\\^$.*+?()[\]{}|]/g,ym=/\w*$/,xm=/^\[object .+?Constructor\]$/,wm=/^(?:0|[1-9]\d*)$/,F={};F[Bi]=F[mm]=F[Iu]=F[In]=F[Eu]=F[_u]=F[Ou]=F[Uu]=F[Ru]=F[Pu]=F[Bu]=F[Tn]=F[Au]=F[Mi]=F[Cu]=F[kn]=F[Tu]=F[ku]=F[Nu]=F[Mu]=F[Fu]=F[Lu]=!0;F[hm]=F[Ni]=F[ki]=!1;var gm=typeof global=="object"&&global&&global.Object===Object&&global,vm=typeof self=="object"&&self&&self.Object===Object&&self,ze=gm||vm||Function("return this")(),ju=typeof Er=="object"&&Er&&!Er.nodeType&&Er,lu=ju&&typeof Jt=="object"&&Jt&&!Jt.nodeType&&Jt,Dm=lu&&lu.exports===ju;function Em(e,t){return e.set(t[0],t[1]),e}function _m(e,t){return e.add(t),e}function Sm(e,t){for(var r=-1,n=e?e.length:0;++r<n&&t(e[r],r,e)!==!1;);return e}function Am(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}function $u(e,t,r,n){var o=-1,i=e?e.length:0;for(n&&i&&(r=e[++o]);++o<i;)r=t(r,e[o],o,e);return r}function Cm(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}function Tm(e,t){return e?.[t]}function zu(e){var t=!1;if(e!=null&&typeof e.toString!="function")try{t=!!(e+"")}catch{}return t}function du(e){var t=-1,r=Array(e.size);return e.forEach(function(n,o){r[++t]=[o,n]}),r}function Fi(e,t){return function(r){return e(t(r))}}function pu(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var km=Array.prototype,Im=Function.prototype,On=Object.prototype,Ti=ze["__core-js_shared__"],mu=function(){var e=/[^.]+$/.exec(Ti&&Ti.keys&&Ti.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),qu=Im.toString,et=On.hasOwnProperty,Un=On.toString,Om=RegExp("^"+qu.call(et).replace(bm,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),hu=Dm?ze.Buffer:void 0,bu=ze.Symbol,yu=ze.Uint8Array,Um=Fi(Object.getPrototypeOf,Object),Rm=Object.create,Pm=On.propertyIsEnumerable,Bm=km.splice,xu=Object.getOwnPropertySymbols,Nm=hu?hu.isBuffer:void 0,Mm=Fi(Object.keys,Object),Ii=Wt(ze,"DataView"),_r=Wt(ze,"Map"),Oi=Wt(ze,"Promise"),Ui=Wt(ze,"Set"),Ri=Wt(ze,"WeakMap"),Sr=Wt(Object,"create"),Fm=bt(Ii),Lm=bt(_r),jm=bt(Oi),$m=bt(Ui),zm=bt(Ri),wu=bu?bu.prototype:void 0,gu=wu?wu.valueOf:void 0;function ht(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function qm(){this.__data__=Sr?Sr(null):{}}function Gm(e){return this.has(e)&&delete this.__data__[e]}function Jm(e){var t=this.__data__;if(Sr){var r=t[e];return r===vu?void 0:r}return et.call(t,e)?t[e]:void 0}function Hm(e){var t=this.__data__;return Sr?t[e]!==void 0:et.call(t,e)}function Vm(e,t){var r=this.__data__;return r[e]=Sr&&t===void 0?vu:t,this}ht.prototype.clear=qm;ht.prototype.delete=Gm;ht.prototype.get=Jm;ht.prototype.has=Hm;ht.prototype.set=Vm;function qe(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Wm(){this.__data__=[]}function Ym(e){var t=this.__data__,r=Rn(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():Bm.call(t,r,1),!0}function Km(e){var t=this.__data__,r=Rn(t,e);return r<0?void 0:t[r][1]}function Xm(e){return Rn(this.__data__,e)>-1}function Zm(e,t){var r=this.__data__,n=Rn(r,e);return n<0?r.push([e,t]):r[n][1]=t,this}qe.prototype.clear=Wm;qe.prototype.delete=Ym;qe.prototype.get=Km;qe.prototype.has=Xm;qe.prototype.set=Zm;function Ht(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Qm(){this.__data__={hash:new ht,map:new(_r||qe),string:new ht}}function eh(e){return Pn(this,e).delete(e)}function th(e){return Pn(this,e).get(e)}function rh(e){return Pn(this,e).has(e)}function nh(e,t){return Pn(this,e).set(e,t),this}Ht.prototype.clear=Qm;Ht.prototype.delete=eh;Ht.prototype.get=th;Ht.prototype.has=rh;Ht.prototype.set=nh;function Vt(e){this.__data__=new qe(e)}function oh(){this.__data__=new qe}function ih(e){return this.__data__.delete(e)}function sh(e){return this.__data__.get(e)}function ah(e){return this.__data__.has(e)}function ch(e,t){var r=this.__data__;if(r instanceof qe){var n=r.__data__;if(!_r||n.length<pm-1)return n.push([e,t]),this;r=this.__data__=new Ht(n)}return r.set(e,t),this}Vt.prototype.clear=oh;Vt.prototype.delete=ih;Vt.prototype.get=sh;Vt.prototype.has=ah;Vt.prototype.set=ch;function uh(e,t){var r=ji(e)||Rh(e)?Cm(e.length,String):[],n=r.length,o=!!n;for(var i in e)(t||et.call(e,i))&&!(o&&(i=="length"||kh(i,n)))&&r.push(i);return r}function Gu(e,t,r){var n=e[t];(!(et.call(e,t)&&Wu(n,r))||r===void 0&&!(t in e))&&(e[t]=r)}function Rn(e,t){for(var r=e.length;r--;)if(Wu(e[r][0],t))return r;return-1}function fh(e,t){return e&&Ju(t,$i(t),e)}function Pi(e,t,r,n,o,i,s){var a;if(n&&(a=i?n(e,o,i,s):n(e)),a!==void 0)return a;if(!Bn(e))return e;var c=ji(e);if(c){if(a=Ah(e),!t)return Eh(e,a)}else{var u=mt(e),d=u==Ni||u==Su;if(Bh(e))return bh(e,t);if(u==Mi||u==Bi||d&&!i){if(zu(e))return i?e:{};if(a=Ch(d?{}:e),!t)return _h(e,fh(a,e))}else{if(!F[u])return i?e:{};a=Th(e,u,Pi,t)}}s||(s=new Vt);var w=s.get(e);if(w)return w;if(s.set(e,a),!c)var x=r?Sh(e):$i(e);return Sm(x||e,function(h,y){x&&(y=h,h=e[y]),Gu(a,y,Pi(h,t,r,n,y,e,s))}),a}function lh(e){return Bn(e)?Rm(e):{}}function dh(e,t,r){var n=t(e);return ji(e)?n:Am(n,r(e))}function ph(e){return Un.call(e)}function mh(e){if(!Bn(e)||Oh(e))return!1;var t=Ku(e)||zu(e)?Om:xm;return t.test(bt(e))}function hh(e){if(!Vu(e))return Mm(e);var t=[];for(var r in Object(e))et.call(e,r)&&r!="constructor"&&t.push(r);return t}function bh(e,t){if(t)return e.slice();var r=new e.constructor(e.length);return e.copy(r),r}function Li(e){var t=new e.constructor(e.byteLength);return new yu(t).set(new yu(e)),t}function yh(e,t){var r=t?Li(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}function xh(e,t,r){var n=t?r(du(e),!0):du(e);return $u(n,Em,new e.constructor)}function wh(e){var t=new e.constructor(e.source,ym.exec(e));return t.lastIndex=e.lastIndex,t}function gh(e,t,r){var n=t?r(pu(e),!0):pu(e);return $u(n,_m,new e.constructor)}function vh(e){return gu?Object(gu.call(e)):{}}function Dh(e,t){var r=t?Li(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}function Eh(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}function Ju(e,t,r,n){r||(r={});for(var o=-1,i=t.length;++o<i;){var s=t[o],a=n?n(r[s],e[s],s,r,e):void 0;Gu(r,s,a===void 0?e[s]:a)}return r}function _h(e,t){return Ju(e,Hu(e),t)}function Sh(e){return dh(e,$i,Hu)}function Pn(e,t){var r=e.__data__;return Ih(t)?r[typeof t=="string"?"string":"hash"]:r.map}function Wt(e,t){var r=Tm(e,t);return mh(r)?r:void 0}var Hu=xu?Fi(xu,Object):Fh,mt=ph;(Ii&&mt(new Ii(new ArrayBuffer(1)))!=In||_r&&mt(new _r)!=Tn||Oi&&mt(Oi.resolve())!=fu||Ui&&mt(new Ui)!=kn||Ri&&mt(new Ri)!=ki)&&(mt=function(e){var t=Un.call(e),r=t==Mi?e.constructor:void 0,n=r?bt(r):void 0;if(n)switch(n){case Fm:return In;case Lm:return Tn;case jm:return fu;case $m:return kn;case zm:return ki}return t});function Ah(e){var t=e.length,r=e.constructor(t);return t&&typeof e[0]=="string"&&et.call(e,"index")&&(r.index=e.index,r.input=e.input),r}function Ch(e){return typeof e.constructor=="function"&&!Vu(e)?lh(Um(e)):{}}function Th(e,t,r,n){var o=e.constructor;switch(t){case Iu:return Li(e);case Eu:case _u:return new o(+e);case In:return yh(e,n);case Ou:case Uu:case Ru:case Pu:case Bu:case Nu:case Mu:case Fu:case Lu:return Dh(e,n);case Tn:return xh(e,n,r);case Au:case Tu:return new o(e);case Cu:return wh(e);case kn:return gh(e,n,r);case ku:return vh(e)}}function kh(e,t){return t=t??Du,!!t&&(typeof e=="number"||wm.test(e))&&e>-1&&e%1==0&&e<t}function Ih(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Oh(e){return!!mu&&mu in e}function Vu(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||On;return e===r}function bt(e){if(e!=null){try{return qu.call(e)}catch{}try{return e+""}catch{}}return""}function Uh(e){return Pi(e,!0,!0)}function Wu(e,t){return e===t||e!==e&&t!==t}function Rh(e){return Ph(e)&&et.call(e,"callee")&&(!Pm.call(e,"callee")||Un.call(e)==Bi)}var ji=Array.isArray;function Yu(e){return e!=null&&Nh(e.length)&&!Ku(e)}function Ph(e){return Mh(e)&&Yu(e)}var Bh=Nm||Lh;function Ku(e){var t=Bn(e)?Un.call(e):"";return t==Ni||t==Su}function Nh(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Du}function Bn(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function Mh(e){return!!e&&typeof e=="object"}function $i(e){return Yu(e)?uh(e):hh(e)}function Fh(){return[]}function Lh(){return!1}Jt.exports=Uh});var ef=M((Ge,Qu)=>{var Zu=typeof self<"u"?self:Ge,Nn=function(){function e(){this.fetch=!1,this.DOMException=Zu.DOMException}return e.prototype=Zu,new e}();(function(e){var t=function(r){var n={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};function o(f){return f&&DataView.prototype.isPrototypeOf(f)}if(n.arrayBuffer)var i=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s=ArrayBuffer.isView||function(f){return f&&i.indexOf(Object.prototype.toString.call(f))>-1};function a(f){if(typeof f!="string"&&(f=String(f)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(f))throw new TypeError("Invalid character in header field name");return f.toLowerCase()}function c(f){return typeof f!="string"&&(f=String(f)),f}function u(f){var m={next:function(){var S=f.shift();return{done:S===void 0,value:S}}};return n.iterable&&(m[Symbol.iterator]=function(){return m}),m}function d(f){this.map={},f instanceof d?f.forEach(function(m,S){this.append(S,m)},this):Array.isArray(f)?f.forEach(function(m){this.append(m[0],m[1])},this):f&&Object.getOwnPropertyNames(f).forEach(function(m){this.append(m,f[m])},this)}d.prototype.append=function(f,m){f=a(f),m=c(m);var S=this.map[f];this.map[f]=S?S+", "+m:m},d.prototype.delete=function(f){delete this.map[a(f)]},d.prototype.get=function(f){return f=a(f),this.has(f)?this.map[f]:null},d.prototype.has=function(f){return this.map.hasOwnProperty(a(f))},d.prototype.set=function(f,m){this.map[a(f)]=c(m)},d.prototype.forEach=function(f,m){for(var S in this.map)this.map.hasOwnProperty(S)&&f.call(m,this.map[S],S,this)},d.prototype.keys=function(){var f=[];return this.forEach(function(m,S){f.push(S)}),u(f)},d.prototype.values=function(){var f=[];return this.forEach(function(m){f.push(m)}),u(f)},d.prototype.entries=function(){var f=[];return this.forEach(function(m,S){f.push([S,m])}),u(f)},n.iterable&&(d.prototype[Symbol.iterator]=d.prototype.entries);function w(f){if(f.bodyUsed)return Promise.reject(new TypeError("Already read"));f.bodyUsed=!0}function x(f){return new Promise(function(m,S){f.onload=function(){m(f.result)},f.onerror=function(){S(f.error)}})}function h(f){var m=new FileReader,S=x(m);return m.readAsArrayBuffer(f),S}function y(f){var m=new FileReader,S=x(m);return m.readAsText(f),S}function v(f){for(var m=new Uint8Array(f),S=new Array(m.length),re=0;re<m.length;re++)S[re]=String.fromCharCode(m[re]);return S.join("")}function L(f){if(f.slice)return f.slice(0);var m=new Uint8Array(f.byteLength);return m.set(new Uint8Array(f)),m.buffer}function k(){return this.bodyUsed=!1,this._initBody=function(f){this._bodyInit=f,f?typeof f=="string"?this._bodyText=f:n.blob&&Blob.prototype.isPrototypeOf(f)?this._bodyBlob=f:n.formData&&FormData.prototype.isPrototypeOf(f)?this._bodyFormData=f:n.searchParams&&URLSearchParams.prototype.isPrototypeOf(f)?this._bodyText=f.toString():n.arrayBuffer&&n.blob&&o(f)?(this._bodyArrayBuffer=L(f.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):n.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(f)||s(f))?this._bodyArrayBuffer=L(f):this._bodyText=f=Object.prototype.toString.call(f):this._bodyText="",this.headers.get("content-type")||(typeof f=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n.searchParams&&URLSearchParams.prototype.isPrototypeOf(f)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},n.blob&&(this.blob=function(){var f=w(this);if(f)return f;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?w(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(h)}),this.text=function(){var f=w(this);if(f)return f;if(this._bodyBlob)return y(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(v(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},n.formData&&(this.formData=function(){return this.text().then(J)}),this.json=function(){return this.text().then(JSON.parse)},this}var U=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function j(f){var m=f.toUpperCase();return U.indexOf(m)>-1?m:f}function I(f,m){m=m||{};var S=m.body;if(f instanceof I){if(f.bodyUsed)throw new TypeError("Already read");this.url=f.url,this.credentials=f.credentials,m.headers||(this.headers=new d(f.headers)),this.method=f.method,this.mode=f.mode,this.signal=f.signal,!S&&f._bodyInit!=null&&(S=f._bodyInit,f.bodyUsed=!0)}else this.url=String(f);if(this.credentials=m.credentials||this.credentials||"same-origin",(m.headers||!this.headers)&&(this.headers=new d(m.headers)),this.method=j(m.method||this.method||"GET"),this.mode=m.mode||this.mode||null,this.signal=m.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&S)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(S)}I.prototype.clone=function(){return new I(this,{body:this._bodyInit})};function J(f){var m=new FormData;return f.trim().split("&").forEach(function(S){if(S){var re=S.split("="),K=re.shift().replace(/\+/g," "),R=re.join("=").replace(/\+/g," ");m.append(decodeURIComponent(K),decodeURIComponent(R))}}),m}function z(f){var m=new d,S=f.replace(/\r?\n[\t ]+/g," ");return S.split(/\r?\n/).forEach(function(re){var K=re.split(":"),R=K.shift().trim();if(R){var Mr=K.join(":").trim();m.append(R,Mr)}}),m}k.call(I.prototype);function C(f,m){m||(m={}),this.type="default",this.status=m.status===void 0?200:m.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in m?m.statusText:"OK",this.headers=new d(m.headers),this.url=m.url||"",this._initBody(f)}k.call(C.prototype),C.prototype.clone=function(){return new C(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},C.error=function(){var f=new C(null,{status:0,statusText:""});return f.type="error",f};var te=[301,302,303,307,308];C.redirect=function(f,m){if(te.indexOf(m)===-1)throw new RangeError("Invalid status code");return new C(null,{status:m,headers:{location:f}})},r.DOMException=e.DOMException;try{new r.DOMException}catch{r.DOMException=function(m,S){this.message=m,this.name=S;var re=Error(m);this.stack=re.stack},r.DOMException.prototype=Object.create(Error.prototype),r.DOMException.prototype.constructor=r.DOMException}function We(f,m){return new Promise(function(S,re){var K=new I(f,m);if(K.signal&&K.signal.aborted)return re(new r.DOMException("Aborted","AbortError"));var R=new XMLHttpRequest;function Mr(){R.abort()}R.onload=function(){var rr={status:R.status,statusText:R.statusText,headers:z(R.getAllResponseHeaders()||"")};rr.url="responseURL"in R?R.responseURL:rr.headers.get("X-Request-URL");var so="response"in R?R.response:R.responseText;S(new C(so,rr))},R.onerror=function(){re(new TypeError("Network request failed"))},R.ontimeout=function(){re(new TypeError("Network request failed"))},R.onabort=function(){re(new r.DOMException("Aborted","AbortError"))},R.open(K.method,K.url,!0),K.credentials==="include"?R.withCredentials=!0:K.credentials==="omit"&&(R.withCredentials=!1),"responseType"in R&&n.blob&&(R.responseType="blob"),K.headers.forEach(function(rr,so){R.setRequestHeader(so,rr)}),K.signal&&(K.signal.addEventListener("abort",Mr),R.onreadystatechange=function(){R.readyState===4&&K.signal.removeEventListener("abort",Mr)}),R.send(typeof K._bodyInit>"u"?null:K._bodyInit)})}return We.polyfill=!0,e.fetch||(e.fetch=We,e.Headers=d,e.Request=I,e.Response=C),r.Headers=d,r.Request=I,r.Response=C,r.fetch=We,Object.defineProperty(r,"__esModule",{value:!0}),r}({})})(Nn);Nn.fetch.ponyfill=!0;delete Nn.fetch.polyfill;var Yt=Nn;Ge=Yt.fetch;Ge.default=Yt.fetch;Ge.fetch=Yt.fetch;Ge.Headers=Yt.Headers;Ge.Request=Yt.Request;Ge.Response=Yt.Response;Qu.exports=Ge});var af=M(Fn=>{"use strict";Object.defineProperty(Fn,"__esModule",{value:!0});Fn.BrowserRandomSource=void 0;var sf=65536,Gi=class{constructor(){this.isAvailable=!1,this.isInstantiated=!1;let t=typeof self<"u"?self.crypto||self.msCrypto:null;t&&t.getRandomValues!==void 0&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");let r=new Uint8Array(t);for(let n=0;n<r.length;n+=sf)this._crypto.getRandomValues(r.subarray(n,n+Math.min(r.length-n,sf)));return r}};Fn.BrowserRandomSource=Gi});var Hi=M(Ji=>{"use strict";Object.defineProperty(Ji,"__esModule",{value:!0});function $h(e){for(var t=0;t<e.length;t++)e[t]=0;return e}Ji.wipe=$h});var cf=M(()=>{});var uf=M(Ln=>{"use strict";Object.defineProperty(Ln,"__esModule",{value:!0});Ln.NodeRandomSource=void 0;var zh=Hi(),Vi=class{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof ws<"u"){let t=cf();t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(t);if(r.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");let n=new Uint8Array(t);for(let o=0;o<n.length;o++)n[o]=r[o];return(0,zh.wipe)(r),n}};Ln.NodeRandomSource=Vi});var ff=M(jn=>{"use strict";Object.defineProperty(jn,"__esModule",{value:!0});jn.SystemRandomSource=void 0;var qh=af(),Gh=uf(),Wi=class{constructor(){if(this.isAvailable=!1,this.name="",this._source=new qh.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Gh.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)}};jn.SystemRandomSource=Wi});var lf=M(be=>{"use strict";Object.defineProperty(be,"__esModule",{value:!0});function Jh(e,t){var r=e>>>16&65535,n=e&65535,o=t>>>16&65535,i=t&65535;return n*i+(r*i+n*o<<16>>>0)|0}be.mul=Math.imul||Jh;function Hh(e,t){return e+t|0}be.add=Hh;function Vh(e,t){return e-t|0}be.sub=Vh;function Wh(e,t){return e<<t|e>>>32-t}be.rotl=Wh;function Yh(e,t){return e<<32-t|e>>>t}be.rotr=Yh;function Kh(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e}be.isInteger=Number.isInteger||Kh;be.MAX_SAFE_INTEGER=9007199254740991;be.isSafeInteger=function(e){return be.isInteger(e)&&e>=-be.MAX_SAFE_INTEGER&&e<=be.MAX_SAFE_INTEGER}});var yf=M(A=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});var df=lf();function Xh(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])<<16>>16}A.readInt16BE=Xh;function Zh(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])>>>0}A.readUint16BE=Zh;function Qh(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])<<16>>16}A.readInt16LE=Qh;function eb(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])>>>0}A.readUint16LE=eb;function pf(e,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=e>>>8,t[r+1]=e>>>0,t}A.writeUint16BE=pf;A.writeInt16BE=pf;function mf(e,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t}A.writeUint16LE=mf;A.writeInt16LE=mf;function Yi(e,t){return t===void 0&&(t=0),e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}A.readInt32BE=Yi;function Ki(e,t){return t===void 0&&(t=0),(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}A.readUint32BE=Ki;function Xi(e,t){return t===void 0&&(t=0),e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}A.readInt32LE=Xi;function Zi(e,t){return t===void 0&&(t=0),(e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t])>>>0}A.readUint32LE=Zi;function $n(e,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=e>>>24,t[r+1]=e>>>16,t[r+2]=e>>>8,t[r+3]=e>>>0,t}A.writeUint32BE=$n;A.writeInt32BE=$n;function zn(e,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24,t}A.writeUint32LE=zn;A.writeInt32LE=zn;function tb(e,t){t===void 0&&(t=0);var r=Yi(e,t),n=Yi(e,t+4);return r*4294967296+n-(n>>31)*4294967296}A.readInt64BE=tb;function rb(e,t){t===void 0&&(t=0);var r=Ki(e,t),n=Ki(e,t+4);return r*4294967296+n}A.readUint64BE=rb;function nb(e,t){t===void 0&&(t=0);var r=Xi(e,t),n=Xi(e,t+4);return n*4294967296+r-(r>>31)*4294967296}A.readInt64LE=nb;function ob(e,t){t===void 0&&(t=0);var r=Zi(e,t),n=Zi(e,t+4);return n*4294967296+r}A.readUint64LE=ob;function hf(e,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),$n(e/4294967296>>>0,t,r),$n(e>>>0,t,r+4),t}A.writeUint64BE=hf;A.writeInt64BE=hf;function bf(e,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),zn(e>>>0,t,r),zn(e/4294967296>>>0,t,r+4),t}A.writeUint64LE=bf;A.writeInt64LE=bf;function ib(e,t,r){if(r===void 0&&(r=0),e%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,o=1,i=e/8+r-1;i>=r;i--)n+=t[i]*o,o*=256;return n}A.readUintBE=ib;function sb(e,t,r){if(r===void 0&&(r=0),e%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,o=1,i=r;i<r+e/8;i++)n+=t[i]*o,o*=256;return n}A.readUintLE=sb;function ab(e,t,r,n){if(r===void 0&&(r=new Uint8Array(e/8)),n===void 0&&(n=0),e%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!df.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var o=1,i=e/8+n-1;i>=n;i--)r[i]=t/o&255,o*=256;return r}A.writeUintBE=ab;function cb(e,t,r,n){if(r===void 0&&(r=new Uint8Array(e/8)),n===void 0&&(n=0),e%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!df.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var o=1,i=n;i<n+e/8;i++)r[i]=t/o&255,o*=256;return r}A.writeUintLE=cb;function ub(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat32(t)}A.readFloat32BE=ub;function fb(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat32(t,!0)}A.readFloat32LE=fb;function lb(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat64(t)}A.readFloat64BE=lb;function db(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat64(t,!0)}A.readFloat64LE=db;function pb(e,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat32(r,e),t}A.writeFloat32BE=pb;function mb(e,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat32(r,e,!0),t}A.writeFloat32LE=mb;function hb(e,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat64(r,e),t}A.writeFloat64BE=hb;function bb(e,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat64(r,e,!0),t}A.writeFloat64LE=bb});var es=M(ie=>{"use strict";Object.defineProperty(ie,"__esModule",{value:!0});ie.randomStringForEntropy=ie.randomString=ie.randomUint32=ie.randomBytes=ie.defaultRandomSource=void 0;var yb=ff(),xb=yf(),xf=Hi();ie.defaultRandomSource=new yb.SystemRandomSource;function Qi(e,t=ie.defaultRandomSource){return t.randomBytes(e)}ie.randomBytes=Qi;function wb(e=ie.defaultRandomSource){let t=Qi(4,e),r=(0,xb.readUint32LE)(t);return(0,xf.wipe)(t),r}ie.randomUint32=wb;var wf="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function gf(e,t=wf,r=ie.defaultRandomSource){if(t.length<2)throw new Error("randomString charset is too short");if(t.length>256)throw new Error("randomString charset is too long");let n="",o=t.length,i=256-256%o;for(;e>0;){let s=Qi(Math.ceil(e*256/i),r);for(let a=0;a<s.length&&e>0;a++){let c=s[a];c<i&&(n+=t.charAt(c%o),e--)}(0,xf.wipe)(s)}return n}ie.randomString=gf;function gb(e,t=wf,r=ie.defaultRandomSource){let n=Math.ceil(e/(Math.log(t.length)/Math.LN2));return gf(n,t,r)}ie.randomStringForEntropy=gb});var Bf=M((xE,Pf)=>{"use strict";function Zb(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var n=0;n<e.length;n++){var o=e.charAt(n),i=o.charCodeAt(0);if(t[i]!==255)throw new TypeError(o+" is ambiguous");t[i]=n}var s=e.length,a=e.charAt(0),c=Math.log(s)/Math.log(256),u=Math.log(256)/Math.log(s);function d(h){if(h instanceof Uint8Array||(ArrayBuffer.isView(h)?h=new Uint8Array(h.buffer,h.byteOffset,h.byteLength):Array.isArray(h)&&(h=Uint8Array.from(h))),!(h instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(h.length===0)return"";for(var y=0,v=0,L=0,k=h.length;L!==k&&h[L]===0;)L++,y++;for(var U=(k-L)*u+1>>>0,j=new Uint8Array(U);L!==k;){for(var I=h[L],J=0,z=U-1;(I!==0||J<v)&&z!==-1;z--,J++)I+=256*j[z]>>>0,j[z]=I%s>>>0,I=I/s>>>0;if(I!==0)throw new Error("Non-zero carry");v=J,L++}for(var C=U-v;C!==U&&j[C]===0;)C++;for(var te=a.repeat(y);C<U;++C)te+=e.charAt(j[C]);return te}function w(h){if(typeof h!="string")throw new TypeError("Expected String");if(h.length===0)return new Uint8Array;var y=0;if(h[y]!==" "){for(var v=0,L=0;h[y]===a;)v++,y++;for(var k=(h.length-y)*c+1>>>0,U=new Uint8Array(k);h[y];){var j=t[h.charCodeAt(y)];if(j===255)return;for(var I=0,J=k-1;(j!==0||I<L)&&J!==-1;J--,I++)j+=s*U[J]>>>0,U[J]=j%256>>>0,j=j/256>>>0;if(j!==0)throw new Error("Non-zero carry");L=I,y++}if(h[y]!==" "){for(var z=k-L;z!==k&&U[z]===0;)z++;for(var C=new Uint8Array(v+(k-z)),te=v;z!==k;)C[te++]=U[z++];return C}}}function x(h){var y=w(h);if(y)return y;throw new Error("Non-base"+s+" character")}return{encode:d,decodeUnsafe:w,decode:x}}Pf.exports=Zb});var Qn=M((wE,Nf)=>{"use strict";var Qb=new TextDecoder,ey=e=>Qb.decode(e),ty=new TextEncoder,ry=e=>ty.encode(e);function ny(e,t){let r=new Uint8Array(t),n=0;for(let o of e)r.set(o,n),n+=o.length;return r}Nf.exports={decodeText:ey,encodeText:ry,concat:ny}});var Ff=M((gE,Mf)=>{"use strict";var{encodeText:oy}=Qn(),hs=class{constructor(t,r,n,o){this.name=t,this.code=r,this.codeBuf=oy(this.code),this.alphabet=o,this.codec=n(o)}encode(t){return this.codec.encode(t)}decode(t){for(let r of t)if(this.alphabet&&this.alphabet.indexOf(r)<0)throw new Error(`invalid character '${r}' in '${t}'`);return this.codec.decode(t)}};Mf.exports=hs});var jf=M((vE,Lf)=>{"use strict";var iy=(e,t,r)=>{let n={};for(let u=0;u<t.length;++u)n[t[u]]=u;let o=e.length;for(;e[o-1]==="=";)--o;let i=new Uint8Array(o*r/8|0),s=0,a=0,c=0;for(let u=0;u<o;++u){let d=n[e[u]];if(d===void 0)throw new SyntaxError("Invalid character "+e[u]);a=a<<r|d,s+=r,s>=8&&(s-=8,i[c++]=255&a>>s)}if(s>=r||255&a<<8-s)throw new SyntaxError("Unexpected end of data");return i},sy=(e,t,r)=>{let n=t[t.length-1]==="=",o=(1<<r)-1,i="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>r;)s-=r,i+=t[o&a>>s];if(s&&(i+=t[o&a<<r-s]),n)for(;i.length*r&7;)i+="=";return i},ay=e=>t=>({encode(r){return sy(r,t,e)},decode(r){return iy(r,t,e)}});Lf.exports={rfc4648:ay}});var Gf=M((DE,qf)=>{"use strict";var Br=Bf(),cy=Ff(),{rfc4648:ee}=jf(),{decodeText:uy,encodeText:fy}=Qn(),ly=()=>({encode:uy,decode:fy}),$f=[["identity","\0",ly,""],["base2","0",ee(1),"01"],["base8","7",ee(3),"01234567"],["base10","9",Br,"0123456789"],["base16","f",ee(4),"0123456789abcdef"],["base16upper","F",ee(4),"0123456789ABCDEF"],["base32hex","v",ee(5),"0123456789abcdefghijklmnopqrstuv"],["base32hexupper","V",ee(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV"],["base32hexpad","t",ee(5),"0123456789abcdefghijklmnopqrstuv="],["base32hexpadupper","T",ee(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV="],["base32","b",ee(5),"abcdefghijklmnopqrstuvwxyz234567"],["base32upper","B",ee(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"],["base32pad","c",ee(5),"abcdefghijklmnopqrstuvwxyz234567="],["base32padupper","C",ee(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="],["base32z","h",ee(5),"ybndrfg8ejkmcpqxot1uwisza345h769"],["base36","k",Br,"0123456789abcdefghijklmnopqrstuvwxyz"],["base36upper","K",Br,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"],["base58btc","z",Br,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base58flickr","Z",Br,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base64","m",ee(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",ee(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",ee(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",ee(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],zf=$f.reduce((e,t)=>(e[t[0]]=new cy(t[0],t[1],t[2],t[3]),e),{}),dy=$f.reduce((e,t)=>(e[t[1]]=zf[t[0]],e),{});qf.exports={names:zf,codes:dy}});var Vf=M((Ve,Hf)=>{"use strict";var Qt=Gf(),{encodeText:py,decodeText:eo,concat:Jf}=Qn();function my(e,t){if(!t)throw new Error("requires an encoded Uint8Array");let{name:r,codeBuf:n}=gt(e);return xy(r,t),Jf([n,t],n.length+t.length)}function hy(e,t){let r=gt(e),n=py(r.encode(t));return Jf([r.codeBuf,n],r.codeBuf.length+n.length)}function by(e){e instanceof Uint8Array&&(e=eo(e));let t=e[0];return["f","F","v","V","t","T","b","B","c","C","h","k","K"].includes(t)&&(e=e.toLowerCase()),gt(e[0]).decode(e.substring(1))}function yy(e){if(e instanceof Uint8Array&&(e=eo(e)),Object.prototype.toString.call(e)!=="[object String]")return!1;try{return gt(e[0]).name}catch{return!1}}function xy(e,t){gt(e).decode(eo(t))}function gt(e){if(Object.prototype.hasOwnProperty.call(Qt.names,e))return Qt.names[e];if(Object.prototype.hasOwnProperty.call(Qt.codes,e))return Qt.codes[e];throw new Error(`Unsupported encoding: ${e}`)}function wy(e){return e instanceof Uint8Array&&(e=eo(e)),gt(e[0])}Ve=Hf.exports=my;Ve.encode=hy;Ve.decode=by;Ve.isEncoded=yy;Ve.encoding=gt;Ve.encodingFromData=wy;var gy=Object.freeze(Qt.names),vy=Object.freeze(Qt.codes);Ve.names=gy;Ve.codes=vy});var Xf=M((EE,Kf)=>{Kf.exports=Yf;var Wf=128,Dy=127,Ey=~Dy,_y=Math.pow(2,31);function Yf(e,t,r){t=t||[],r=r||0;for(var n=r;e>=_y;)t[r++]=e&255|Wf,e/=128;for(;e&Ey;)t[r++]=e&255|Wf,e>>>=7;return t[r]=e|0,Yf.bytes=r-n+1,t}});var el=M((_E,Qf)=>{Qf.exports=bs;var Sy=128,Zf=127;function bs(e,n){var r=0,n=n||0,o=0,i=n,s,a=e.length;do{if(i>=a)throw bs.bytes=0,new RangeError("Could not decode varint");s=e[i++],r+=o<28?(s&Zf)<<o:(s&Zf)*Math.pow(2,o),o+=7}while(s>=Sy);return bs.bytes=i-n,r}});var rl=M((SE,tl)=>{var Ay=Math.pow(2,7),Cy=Math.pow(2,14),Ty=Math.pow(2,21),ky=Math.pow(2,28),Iy=Math.pow(2,35),Oy=Math.pow(2,42),Uy=Math.pow(2,49),Ry=Math.pow(2,56),Py=Math.pow(2,63);tl.exports=function(e){return e<Ay?1:e<Cy?2:e<Ty?3:e<ky?4:e<Iy?5:e<Oy?6:e<Uy?7:e<Ry?8:e<Py?9:10}});var ol=M((AE,nl)=>{nl.exports={encode:Xf(),decode:el(),encodingLength:rl()}});var sl=M((CE,il)=>{"use strict";var By=Object.freeze({identity:0,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,"murmur3-128":34,"murmur3-32":35,"dbl-sha2-256":86,md4:212,md5:213,bmt:214,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,kangarootwelve:7425,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082});il.exports={names:By}});var pl=M((TE,dl)=>{"use strict";var al=Vf(),er=ol(),{names:Nr}=sl(),{toString:to}=($o(),Lr(fa)),{fromString:Ny}=(jo(),Lr(ua)),{concat:My}=(vo(),Lr(Gs)),tr={};for(let e in Nr){let t=e;tr[Nr[t]]=t}Object.freeze(tr);function Fy(e){if(!(e instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return to(e,"base16")}function Ly(e){return Ny(e,"base16")}function jy(e){if(!(e instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return to(al.encode("base58btc",e)).slice(1)}function $y(e){let t=e instanceof Uint8Array?to(e):e;return al.decode("z"+t)}function cl(e){if(!(e instanceof Uint8Array))throw new Error("multihash must be a Uint8Array");if(e.length<2)throw new Error("multihash too short. must be > 2 bytes.");let t=er.decode(e);if(!fl(t))throw new Error(`multihash unknown function code: 0x${t.toString(16)}`);e=e.slice(er.decode.bytes);let r=er.decode(e);if(r<0)throw new Error(`multihash invalid length: ${r}`);if(e=e.slice(er.decode.bytes),e.length!==r)throw new Error(`multihash length inconsistent: 0x${to(e,"base16")}`);return{code:t,name:tr[t],length:r,digest:e}}function zy(e,t,r){if(!e||t===void 0)throw new Error("multihash encode requires at least two args: digest, code");let n=ul(t);if(!(e instanceof Uint8Array))throw new Error("digest should be a Uint8Array");if(r==null&&(r=e.length),r&&e.length!==r)throw new Error("digest length should be equal to specified length.");let o=er.encode(n),i=er.encode(r);return My([o,i,e],o.length+i.length+e.length)}function ul(e){let t=e;if(typeof e=="string"){if(Nr[e]===void 0)throw new Error(`Unrecognized hash function named: ${e}`);t=Nr[e]}if(typeof t!="number")throw new Error(`Hash function code should be a number. Got: ${t}`);if(tr[t]===void 0&&!ys(t))throw new Error(`Unrecognized function code: ${t}`);return t}function ys(e){return e>0&&e<16}function fl(e){return!!(ys(e)||tr[e])}function ll(e){cl(e)}function qy(e){return ll(e),e.subarray(0,2)}dl.exports={names:Nr,codes:tr,toHexString:Fy,fromHexString:Ly,toB58String:jy,fromB58String:$y,decode:cl,encode:zy,coerceCode:ul,isAppCode:ys,validate:ll,prefix:qy,isValidCode:fl}});var r0={};H(r0,{CeramicClient:()=>io,TileDocument:()=>He});Me();Ct();var Ps={tile:0,"caip10-link":1,model:2,MID:3,UNLOADABLE:4};function ld(e){let t=Ps[e];if(typeof t<"u")return t;throw new Error(`No stream type registered for name ${e}`)}function dd(e){let t=Object.entries(Ps).find(([,r])=>r===e);if(t)return t[0];throw new Error(`No stream type registered for index ${e}`)}var ce=class{};ce.nameByCode=dd;ce.codeByName=ld;var fi=De(Jr(),1);vo();jo();$o();Hr();ar();function ue(e){let t,r,n;return typeof e=="object"?(t=e.hashFunction,r=e.expiring,n=e.tags):t=e,(o,i,s)=>{if(s.value!=null)s.value=da(s.value,t,r,n);else if(s.get!=null)s.get=da(s.get,t,r,n);else throw"Only put a Memoize() decorator on a method or get accessor."}}var zo=new Map;function da(e,t,r=0,n){let o=Symbol("__memoized_map__");return function(...i){let s;this.hasOwnProperty(o)||Object.defineProperty(this,o,{configurable:!1,enumerable:!1,writable:!1,value:new Map});let a=this[o];if(Array.isArray(n))for(let c of n)zo.has(c)?zo.get(c).push(a):zo.set(c,[a]);if(t||i.length>0||r>0){let c;t===!0?c=i.map(w=>w.toString()).join("!"):t?c=t.apply(this,i):c=i[0];let u=`${c}__timestamp`,d=!1;if(r>0)if(!a.has(u))d=!0;else{let w=a.get(u);d=Date.now()-w>r}a.has(c)&&!d?s=a.get(c):(s=e.apply(this,i),a.set(c,s),r>0&&a.set(u,Date.now()))}else{let c=this;a.has(c)?s=a.get(c):(s=e.apply(this,i),a.set(c,s))}return s}}Me();No();var Wr=({enumerable:e=!0,configurable:t=!1}={})=>({enumerable:e,configurable:t,writable:!1}),qo=function*(e,t){if(e!=null&&!(e instanceof Uint8Array))for(let[r,n]of Object.entries(e)){let o=[...t,r];if(n!=null&&typeof n=="object")if(Array.isArray(n))for(let[i,s]of n.entries()){let a=[...o,i],c=g.asCID(s);c?yield[a.join("/"),c]:typeof s=="object"&&(yield*qo(s,a))}else{let i=g.asCID(n);i?yield[o.join("/"),i]:yield*qo(n,o)}}},Go=function*(e,t){if(e!=null)for(let[r,n]of Object.entries(e)){let o=[...t,r];if(yield o.join("/"),n!=null&&!(n instanceof Uint8Array)&&typeof n=="object"&&!g.asCID(n))if(Array.isArray(n))for(let[i,s]of n.entries()){let a=[...o,i];yield a.join("/"),typeof s=="object"&&!g.asCID(s)&&(yield*Go(s,a))}else yield*Go(n,o)}},Wd=(e,t)=>{let r=e;for(let[n,o]of t.entries()){if(r=r[o],r==null)throw new Error(`Object has no property at ${t.slice(0,n+1).map(s=>`[${JSON.stringify(s)}]`).join("")}`);let i=g.asCID(r);if(i)return{value:i,remaining:t.slice(n+1).join("/")}}return{value:r}},Jo=class{constructor({cid:t,bytes:r,value:n}){if(!t||!r||typeof n>"u")throw new Error("Missing required argument");this.cid=t,this.bytes=r,this.value=n,this.asBlock=this,Object.defineProperties(this,{cid:Wr(),bytes:Wr(),value:Wr(),asBlock:Wr()})}links(){return qo(this.value,[])}tree(){return Go(this.value,[])}get(t="/"){return Wd(this.value,t.split("/").filter(Boolean))}},pa=async({value:e,codec:t,hasher:r})=>{if(typeof e>"u")throw new Error('Missing required argument "value"');if(!t||!r)throw new Error("Missing required argument: codec or hasher");let n=t.encode(e),o=await r.digest(n),i=g.create(1,t.code,o);return new Jo({value:e,bytes:n,cid:i})};Ct();Po();var si=De(Jr(),1);var hr={};H(hr,{code:()=>sn,decode:()=>Up,encode:()=>at,name:()=>Op});var Kd=["string","number","bigint","symbol"],Xd=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function ma(e){if(e===null)return"null";if(e===void 0)return"undefined";if(e===!0||e===!1)return"boolean";let t=typeof e;if(Kd.includes(t))return t;if(t==="function")return"Function";if(Array.isArray(e))return"Array";if(Zd(e))return"Buffer";let r=Qd(e);return r||"Object"}function Zd(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}function Qd(e){let t=Object.prototype.toString.call(e).slice(8,-1);if(Xd.includes(t))return t}var l=class{constructor(t,r,n){this.major=t,this.majorEncoded=t<<5,this.name=r,this.terminal=n}toString(){return`Type[${this.major}].${this.name}`}compare(t){return this.major<t.major?-1:this.major>t.major?1:0}};l.uint=new l(0,"uint",!0);l.negint=new l(1,"negint",!0);l.bytes=new l(2,"bytes",!0);l.string=new l(3,"string",!0);l.array=new l(4,"array",!1);l.map=new l(5,"map",!1);l.tag=new l(6,"tag",!1);l.float=new l(7,"float",!0);l.false=new l(7,"false",!0);l.true=new l(7,"true",!0);l.null=new l(7,"null",!0);l.undefined=new l(7,"undefined",!0);l.break=new l(7,"break",!0);var b=class{constructor(t,r,n){this.type=t,this.value=r,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}};var kt=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",ep=new TextDecoder,tp=new TextEncoder;function Yr(e){return kt&&globalThis.Buffer.isBuffer(e)}function Ho(e){return e instanceof Uint8Array?Yr(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}var xa=kt?(e,t,r)=>r-t>64?globalThis.Buffer.from(e.subarray(t,r)).toString("utf8"):ba(e,t,r):(e,t,r)=>r-t>64?ep.decode(e.subarray(t,r)):ba(e,t,r),wa=kt?e=>e.length>64?globalThis.Buffer.from(e):ha(e):e=>e.length>64?tp.encode(e):ha(e),Oe=e=>Uint8Array.from(e),It=kt?(e,t,r)=>Yr(e)?new Uint8Array(e.subarray(t,r)):e.slice(t,r):(e,t,r)=>e.slice(t,r),ga=kt?(e,t)=>(e=e.map(r=>r instanceof Uint8Array?r:globalThis.Buffer.from(r)),Ho(globalThis.Buffer.concat(e,t))):(e,t)=>{let r=new Uint8Array(t),n=0;for(let o of e)n+o.length>r.length&&(o=o.subarray(0,r.length-n)),r.set(o,n),n+=o.length;return r},va=kt?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function Da(e,t){if(Yr(e)&&Yr(t))return e.compare(t);for(let r=0;r<e.length;r++)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return 0}function ha(e,t=1/0){let r,n=e.length,o=null,i=[];for(let s=0;s<n;++s){if(r=e.charCodeAt(s),r>55295&&r<57344){if(!o){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}else if(s+1===n){(t-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),o=r;continue}r=(o-55296<<10|r-56320)+65536}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,r&63|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return i}function ba(e,t,r){let n=[];for(;t<r;){let o=e[t],i=null,s=o>239?4:o>223?3:o>191?2:1;if(t+s<=r){let a,c,u,d;switch(s){case 1:o<128&&(i=o);break;case 2:a=e[t+1],(a&192)===128&&(d=(o&31)<<6|a&63,d>127&&(i=d));break;case 3:a=e[t+1],c=e[t+2],(a&192)===128&&(c&192)===128&&(d=(o&15)<<12|(a&63)<<6|c&63,d>2047&&(d<55296||d>57343)&&(i=d));break;case 4:a=e[t+1],c=e[t+2],u=e[t+3],(a&192)===128&&(c&192)===128&&(u&192)===128&&(d=(o&15)<<18|(a&63)<<12|(c&63)<<6|u&63,d>65535&&d<1114112&&(i=d))}}i===null?(i=65533,s=1):i>65535&&(i-=65536,n.push(i>>>10&1023|55296),i=56320|i&1023),n.push(i),t+=s}return rp(n)}var ya=4096;function rp(e){let t=e.length;if(t<=ya)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=ya));return r}var np=256,ur=class{constructor(t=np){this.chunkSize=t,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(t){let r=this.chunks[this.chunks.length-1];if(this.cursor+t.length<=this.maxCursor+1){let o=r.length-(this.maxCursor-this.cursor)-1;r.set(t,o)}else{if(r){let o=r.length-(this.maxCursor-this.cursor)-1;o<r.length&&(this.chunks[this.chunks.length-1]=r.subarray(0,o),this.maxCursor=this.cursor-1)}t.length<64&&t.length<this.chunkSize?(r=va(this.chunkSize),this.chunks.push(r),this.maxCursor+=r.length,this._initReuseChunk===null&&(this._initReuseChunk=r),r.set(t,0)):(this.chunks.push(t),this.maxCursor+=t.length)}this.cursor+=t.length}toBytes(t=!1){let r;if(this.chunks.length===1){let n=this.chunks[0];t&&this.cursor>n.length/2?(r=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):r=It(n,0,this.cursor)}else r=ga(this.chunks,this.cursor);return t&&this.reset(),r}};var D="CBOR decode error:",Vo="CBOR encode error:",fr=[];fr[23]=1;fr[24]=2;fr[25]=3;fr[26]=5;fr[27]=9;function Le(e,t,r){if(e.length-t<r)throw new Error(`${D} not enough data for type`)}var V=[24,256,65536,4294967296,BigInt("18446744073709551616")];function fe(e,t,r){Le(e,t,1);let n=e[t];if(r.strict===!0&&n<V[0])throw new Error(`${D} integer encoded in more bytes than necessary (strict decode)`);return n}function le(e,t,r){Le(e,t,2);let n=e[t]<<8|e[t+1];if(r.strict===!0&&n<V[1])throw new Error(`${D} integer encoded in more bytes than necessary (strict decode)`);return n}function de(e,t,r){Le(e,t,4);let n=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(r.strict===!0&&n<V[2])throw new Error(`${D} integer encoded in more bytes than necessary (strict decode)`);return n}function pe(e,t,r){Le(e,t,8);let n=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],o=e[t+4]*16777216+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],i=(BigInt(n)<<BigInt(32))+BigInt(o);if(r.strict===!0&&i<V[3])throw new Error(`${D} integer encoded in more bytes than necessary (strict decode)`);if(i<=Number.MAX_SAFE_INTEGER)return Number(i);if(r.allowBigInt===!0)return i;throw new Error(`${D} integers outside of the safe integer range are not supported`)}function Ea(e,t,r,n){return new b(l.uint,fe(e,t+1,n),2)}function _a(e,t,r,n){return new b(l.uint,le(e,t+1,n),3)}function Sa(e,t,r,n){return new b(l.uint,de(e,t+1,n),5)}function Aa(e,t,r,n){return new b(l.uint,pe(e,t+1,n),9)}function xe(e,t){return X(e,0,t.value)}function X(e,t,r){if(r<V[0]){let n=Number(r);e.push([t|n])}else if(r<V[1]){let n=Number(r);e.push([t|24,n])}else if(r<V[2]){let n=Number(r);e.push([t|25,n>>>8,n&255])}else if(r<V[3]){let n=Number(r);e.push([t|26,n>>>24&255,n>>>16&255,n>>>8&255,n&255])}else{let n=BigInt(r);if(n<V[4]){let o=[t|27,0,0,0,0,0,0,0],i=Number(n&BigInt(4294967295)),s=Number(n>>BigInt(32)&BigInt(4294967295));o[8]=i&255,i=i>>8,o[7]=i&255,i=i>>8,o[6]=i&255,i=i>>8,o[5]=i&255,o[4]=s&255,s=s>>8,o[3]=s&255,s=s>>8,o[2]=s&255,s=s>>8,o[1]=s&255,e.push(o)}else throw new Error(`${D} encountered BigInt larger than allowable range`)}}xe.encodedSize=function(t){return X.encodedSize(t.value)};X.encodedSize=function(t){return t<V[0]?1:t<V[1]?2:t<V[2]?3:t<V[3]?5:9};xe.compareTokens=function(t,r){return t.value<r.value?-1:t.value>r.value?1:0};function Ca(e,t,r,n){return new b(l.negint,-1-fe(e,t+1,n),2)}function Ta(e,t,r,n){return new b(l.negint,-1-le(e,t+1,n),3)}function ka(e,t,r,n){return new b(l.negint,-1-de(e,t+1,n),5)}var Wo=BigInt(-1),Ia=BigInt(1);function Oa(e,t,r,n){let o=pe(e,t+1,n);if(typeof o!="bigint"){let i=-1-o;if(i>=Number.MIN_SAFE_INTEGER)return new b(l.negint,i,9)}if(n.allowBigInt!==!0)throw new Error(`${D} integers outside of the safe integer range are not supported`);return new b(l.negint,Wo-BigInt(o),9)}function Kr(e,t){let r=t.value,n=typeof r=="bigint"?r*Wo-Ia:r*-1-1;X(e,t.type.majorEncoded,n)}Kr.encodedSize=function(t){let r=t.value,n=typeof r=="bigint"?r*Wo-Ia:r*-1-1;return n<V[0]?1:n<V[1]?2:n<V[2]?3:n<V[3]?5:9};Kr.compareTokens=function(t,r){return t.value<r.value?1:t.value>r.value?-1:0};function lr(e,t,r,n){Le(e,t,r+n);let o=It(e,t+r,t+r+n);return new b(l.bytes,o,r+n)}function Ua(e,t,r,n){return lr(e,t,1,r)}function Ra(e,t,r,n){return lr(e,t,2,fe(e,t+1,n))}function Pa(e,t,r,n){return lr(e,t,3,le(e,t+1,n))}function Ba(e,t,r,n){return lr(e,t,5,de(e,t+1,n))}function Na(e,t,r,n){let o=pe(e,t+1,n);if(typeof o=="bigint")throw new Error(`${D} 64-bit integer bytes lengths not supported`);return lr(e,t,9,o)}function Xr(e){return e.encodedBytes===void 0&&(e.encodedBytes=e.type===l.string?wa(e.value):e.value),e.encodedBytes}function Ot(e,t){let r=Xr(t);X(e,t.type.majorEncoded,r.length),e.push(r)}Ot.encodedSize=function(t){let r=Xr(t);return X.encodedSize(r.length)+r.length};Ot.compareTokens=function(t,r){return ip(Xr(t),Xr(r))};function ip(e,t){return e.length<t.length?-1:e.length>t.length?1:Da(e,t)}function dr(e,t,r,n,o){let i=r+n;Le(e,t,i);let s=new b(l.string,xa(e,t+r,t+i),i);return o.retainStringBytes===!0&&(s.byteValue=It(e,t+r,t+i)),s}function Ma(e,t,r,n){return dr(e,t,1,r,n)}function Fa(e,t,r,n){return dr(e,t,2,fe(e,t+1,n),n)}function La(e,t,r,n){return dr(e,t,3,le(e,t+1,n),n)}function ja(e,t,r,n){return dr(e,t,5,de(e,t+1,n),n)}function $a(e,t,r,n){let o=pe(e,t+1,n);if(typeof o=="bigint")throw new Error(`${D} 64-bit integer string lengths not supported`);return dr(e,t,9,o,n)}var za=Ot;function Ut(e,t,r,n){return new b(l.array,n,r)}function qa(e,t,r,n){return Ut(e,t,1,r)}function Ga(e,t,r,n){return Ut(e,t,2,fe(e,t+1,n))}function Ja(e,t,r,n){return Ut(e,t,3,le(e,t+1,n))}function Ha(e,t,r,n){return Ut(e,t,5,de(e,t+1,n))}function Va(e,t,r,n){let o=pe(e,t+1,n);if(typeof o=="bigint")throw new Error(`${D} 64-bit integer array lengths not supported`);return Ut(e,t,9,o)}function Wa(e,t,r,n){if(n.allowIndefinite===!1)throw new Error(`${D} indefinite length items not allowed`);return Ut(e,t,1,1/0)}function Zr(e,t){X(e,l.array.majorEncoded,t.value)}Zr.compareTokens=xe.compareTokens;Zr.encodedSize=function(t){return X.encodedSize(t.value)};function Rt(e,t,r,n){return new b(l.map,n,r)}function Ya(e,t,r,n){return Rt(e,t,1,r)}function Ka(e,t,r,n){return Rt(e,t,2,fe(e,t+1,n))}function Xa(e,t,r,n){return Rt(e,t,3,le(e,t+1,n))}function Za(e,t,r,n){return Rt(e,t,5,de(e,t+1,n))}function Qa(e,t,r,n){let o=pe(e,t+1,n);if(typeof o=="bigint")throw new Error(`${D} 64-bit integer map lengths not supported`);return Rt(e,t,9,o)}function ec(e,t,r,n){if(n.allowIndefinite===!1)throw new Error(`${D} indefinite length items not allowed`);return Rt(e,t,1,1/0)}function Qr(e,t){X(e,l.map.majorEncoded,t.value)}Qr.compareTokens=xe.compareTokens;Qr.encodedSize=function(t){return X.encodedSize(t.value)};function tc(e,t,r,n){return new b(l.tag,r,1)}function rc(e,t,r,n){return new b(l.tag,fe(e,t+1,n),2)}function nc(e,t,r,n){return new b(l.tag,le(e,t+1,n),3)}function oc(e,t,r,n){return new b(l.tag,de(e,t+1,n),5)}function ic(e,t,r,n){return new b(l.tag,pe(e,t+1,n),9)}function en(e,t){X(e,l.tag.majorEncoded,t.value)}en.compareTokens=xe.compareTokens;en.encodedSize=function(t){return X.encodedSize(t.value)};var lp=20,dp=21,pp=22,mp=23;function sc(e,t,r,n){if(n.allowUndefined===!1)throw new Error(`${D} undefined values are not supported`);return n.coerceUndefinedToNull===!0?new b(l.null,null,1):new b(l.undefined,void 0,1)}function ac(e,t,r,n){if(n.allowIndefinite===!1)throw new Error(`${D} indefinite length items not allowed`);return new b(l.break,void 0,1)}function Yo(e,t,r){if(r){if(r.allowNaN===!1&&Number.isNaN(e))throw new Error(`${D} NaN values are not supported`);if(r.allowInfinity===!1&&(e===1/0||e===-1/0))throw new Error(`${D} Infinity values are not supported`)}return new b(l.float,e,t)}function cc(e,t,r,n){return Yo(Ko(e,t+1),3,n)}function uc(e,t,r,n){return Yo(Xo(e,t+1),5,n)}function fc(e,t,r,n){return Yo(mc(e,t+1),9,n)}function tn(e,t,r){let n=t.value;if(n===!1)e.push([l.float.majorEncoded|lp]);else if(n===!0)e.push([l.float.majorEncoded|dp]);else if(n===null)e.push([l.float.majorEncoded|pp]);else if(n===void 0)e.push([l.float.majorEncoded|mp]);else{let o,i=!1;(!r||r.float64!==!0)&&(dc(n),o=Ko(Se,1),n===o||Number.isNaN(n)?(Se[0]=249,e.push(Se.slice(0,3)),i=!0):(pc(n),o=Xo(Se,1),n===o&&(Se[0]=250,e.push(Se.slice(0,5)),i=!0))),i||(hp(n),o=mc(Se,1),Se[0]=251,e.push(Se.slice(0,9)))}}tn.encodedSize=function(t,r){let n=t.value;if(n===!1||n===!0||n===null||n===void 0)return 1;if(!r||r.float64!==!0){dc(n);let o=Ko(Se,1);if(n===o||Number.isNaN(n))return 3;if(pc(n),o=Xo(Se,1),n===o)return 5}return 9};var lc=new ArrayBuffer(9),we=new DataView(lc,1),Se=new Uint8Array(lc,0);function dc(e){if(e===1/0)we.setUint16(0,31744,!1);else if(e===-1/0)we.setUint16(0,64512,!1);else if(Number.isNaN(e))we.setUint16(0,32256,!1);else{we.setFloat32(0,e);let t=we.getUint32(0),r=(t&2139095040)>>23,n=t&8388607;if(r===255)we.setUint16(0,31744,!1);else if(r===0)we.setUint16(0,(e&2147483648)>>16|n>>13,!1);else{let o=r-127;o<-24?we.setUint16(0,0):o<-14?we.setUint16(0,(t&2147483648)>>16|1<<24+o,!1):we.setUint16(0,(t&2147483648)>>16|o+15<<10|n>>13,!1)}}}function Ko(e,t){if(e.length-t<2)throw new Error(`${D} not enough data for float16`);let r=(e[t]<<8)+e[t+1];if(r===31744)return 1/0;if(r===64512)return-1/0;if(r===32256)return NaN;let n=r>>10&31,o=r&1023,i;return n===0?i=o*2**-24:n!==31?i=(o+1024)*2**(n-25):i=o===0?1/0:NaN,r&32768?-i:i}function pc(e){we.setFloat32(0,e,!1)}function Xo(e,t){if(e.length-t<4)throw new Error(`${D} not enough data for float32`);let r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,4).getFloat32(0,!1)}function hp(e){we.setFloat64(0,e,!1)}function mc(e,t){if(e.length-t<8)throw new Error(`${D} not enough data for float64`);let r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,8).getFloat64(0,!1)}tn.compareTokens=xe.compareTokens;function T(e,t,r){throw new Error(`${D} encountered invalid minor (${r}) for major ${e[t]>>>5}`)}function rn(e){return()=>{throw new Error(`${D} ${e}`)}}var p=[];for(let e=0;e<=23;e++)p[e]=T;p[24]=Ea;p[25]=_a;p[26]=Sa;p[27]=Aa;p[28]=T;p[29]=T;p[30]=T;p[31]=T;for(let e=32;e<=55;e++)p[e]=T;p[56]=Ca;p[57]=Ta;p[58]=ka;p[59]=Oa;p[60]=T;p[61]=T;p[62]=T;p[63]=T;for(let e=64;e<=87;e++)p[e]=Ua;p[88]=Ra;p[89]=Pa;p[90]=Ba;p[91]=Na;p[92]=T;p[93]=T;p[94]=T;p[95]=rn("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)p[e]=Ma;p[120]=Fa;p[121]=La;p[122]=ja;p[123]=$a;p[124]=T;p[125]=T;p[126]=T;p[127]=rn("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)p[e]=qa;p[152]=Ga;p[153]=Ja;p[154]=Ha;p[155]=Va;p[156]=T;p[157]=T;p[158]=T;p[159]=Wa;for(let e=160;e<=183;e++)p[e]=Ya;p[184]=Ka;p[185]=Xa;p[186]=Za;p[187]=Qa;p[188]=T;p[189]=T;p[190]=T;p[191]=ec;for(let e=192;e<=215;e++)p[e]=tc;p[216]=rc;p[217]=nc;p[218]=oc;p[219]=ic;p[220]=T;p[221]=T;p[222]=T;p[223]=T;for(let e=224;e<=243;e++)p[e]=rn("simple values are not supported");p[244]=T;p[245]=T;p[246]=T;p[247]=sc;p[248]=rn("simple values are not supported");p[249]=cc;p[250]=uc;p[251]=fc;p[252]=T;p[253]=T;p[254]=T;p[255]=ac;var Ae=[];for(let e=0;e<24;e++)Ae[e]=new b(l.uint,e,1);for(let e=-1;e>=-24;e--)Ae[31-e]=new b(l.negint,e,1);Ae[64]=new b(l.bytes,new Uint8Array(0),1);Ae[96]=new b(l.string,"",1);Ae[128]=new b(l.array,0,1);Ae[160]=new b(l.map,0,1);Ae[244]=new b(l.false,!1,1);Ae[245]=new b(l.true,!0,1);Ae[246]=new b(l.null,null,1);function hc(e){switch(e.type){case l.false:return Oe([244]);case l.true:return Oe([245]);case l.null:return Oe([246]);case l.bytes:return e.value.length?void 0:Oe([64]);case l.string:return e.value===""?Oe([96]):void 0;case l.array:return e.value===0?Oe([128]):void 0;case l.map:return e.value===0?Oe([160]):void 0;case l.uint:return e.value<24?Oe([Number(e.value)]):void 0;case l.negint:if(e.value>=-24)return Oe([31-Number(e.value)])}}var yp={float64:!1,mapSorter:gp,quickEncodeToken:hc};function xp(){let e=[];return e[l.uint.major]=xe,e[l.negint.major]=Kr,e[l.bytes.major]=Ot,e[l.string.major]=za,e[l.array.major]=Zr,e[l.map.major]=Qr,e[l.tag.major]=en,e[l.float.major]=tn,e}var bc=xp(),Zo=new ur,Pt=class{constructor(t,r){this.obj=t,this.parent=r}includes(t){let r=this;do if(r.obj===t)return!0;while(r=r.parent);return!1}static createCheck(t,r){if(t&&t.includes(r))throw new Error(`${Vo} object contains circular references`);return new Pt(r,t)}},Xe={null:new b(l.null,null),undefined:new b(l.undefined,void 0),true:new b(l.true,!0),false:new b(l.false,!1),emptyArray:new b(l.array,0),emptyMap:new b(l.map,0)},Ze={number(e,t,r,n){return!Number.isInteger(e)||!Number.isSafeInteger(e)?new b(l.float,e):e>=0?new b(l.uint,e):new b(l.negint,e)},bigint(e,t,r,n){return e>=BigInt(0)?new b(l.uint,e):new b(l.negint,e)},Uint8Array(e,t,r,n){return new b(l.bytes,e)},string(e,t,r,n){return new b(l.string,e)},boolean(e,t,r,n){return e?Xe.true:Xe.false},null(e,t,r,n){return Xe.null},undefined(e,t,r,n){return Xe.undefined},ArrayBuffer(e,t,r,n){return new b(l.bytes,new Uint8Array(e))},DataView(e,t,r,n){return new b(l.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength))},Array(e,t,r,n){if(!e.length)return r.addBreakTokens===!0?[Xe.emptyArray,new b(l.break)]:Xe.emptyArray;n=Pt.createCheck(n,e);let o=[],i=0;for(let s of e)o[i++]=nn(s,r,n);return r.addBreakTokens?[new b(l.array,e.length),o,new b(l.break)]:[new b(l.array,e.length),o]},Object(e,t,r,n){let o=t!=="Object",i=o?e.keys():Object.keys(e),s=o?e.size:i.length;if(!s)return r.addBreakTokens===!0?[Xe.emptyMap,new b(l.break)]:Xe.emptyMap;n=Pt.createCheck(n,e);let a=[],c=0;for(let u of i)a[c++]=[nn(u,r,n),nn(o?e.get(u):e[u],r,n)];return wp(a,r),r.addBreakTokens?[new b(l.map,s),a,new b(l.break)]:[new b(l.map,s),a]}};Ze.Map=Ze.Object;Ze.Buffer=Ze.Uint8Array;for(let e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Ze[`${e}Array`]=Ze.DataView;function nn(e,t={},r){let n=ma(e),o=t&&t.typeEncoders&&t.typeEncoders[n]||Ze[n];if(typeof o=="function"){let s=o(e,n,t,r);if(s!=null)return s}let i=Ze[n];if(!i)throw new Error(`${Vo} unsupported type: ${n}`);return i(e,n,t,r)}function wp(e,t){t.mapSorter&&e.sort(t.mapSorter)}function gp(e,t){let r=Array.isArray(e[0])?e[0][0]:e[0],n=Array.isArray(t[0])?t[0][0]:t[0];if(r.type!==n.type)return r.type.compare(n.type);let o=r.type.major,i=bc[o].compareTokens(r,n);return i===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),i}function yc(e,t,r,n){if(Array.isArray(t))for(let o of t)yc(e,o,r,n);else r[t.type.major](e,t,n)}function vp(e,t,r){let n=nn(e,r);if(!Array.isArray(n)&&r.quickEncodeToken){let o=r.quickEncodeToken(n);if(o)return o;let i=t[n.type.major];if(i.encodedSize){let s=i.encodedSize(n,r),a=new ur(s);if(i(a,n,r),a.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return Ho(a.chunks[0])}}return Zo.reset(),yc(Zo,n,t,r),Zo.toBytes(!0)}function Qo(e,t){return t=Object.assign({},yp,t),vp(e,bc,t)}var Dp={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},ei=class{constructor(t,r={}){this.pos=0,this.data=t,this.options=r}done(){return this.pos>=this.data.length}next(){let t=this.data[this.pos],r=Ae[t];if(r===void 0){let n=p[t];if(!n)throw new Error(`${D} no decoder for major type ${t>>>5} (byte 0x${t.toString(16).padStart(2,"0")})`);let o=t&31;r=n(this.data,this.pos,o,this.options)}return this.pos+=r.encodedLength,r}},pr=Symbol.for("DONE"),on=Symbol.for("BREAK");function Ep(e,t,r){let n=[];for(let o=0;o<e.value;o++){let i=mr(t,r);if(i===on){if(e.value===1/0)break;throw new Error(`${D} got unexpected break to lengthed array`)}if(i===pr)throw new Error(`${D} found array but not enough entries (got ${o}, expected ${e.value})`);n[o]=i}return n}function _p(e,t,r){let n=r.useMaps===!0,o=n?void 0:{},i=n?new Map:void 0;for(let s=0;s<e.value;s++){let a=mr(t,r);if(a===on){if(e.value===1/0)break;throw new Error(`${D} got unexpected break to lengthed map`)}if(a===pr)throw new Error(`${D} found map but not enough entries (got ${s} [no key], expected ${e.value})`);if(n!==!0&&typeof a!="string")throw new Error(`${D} non-string keys not supported (got ${typeof a})`);let c=mr(t,r);if(c===pr)throw new Error(`${D} found map but not enough entries (got ${s} [no value], expected ${e.value})`);n?i.set(a,c):o[a]=c}return n?i:o}function mr(e,t){if(e.done())return pr;let r=e.next();if(r.type===l.break)return on;if(r.type.terminal)return r.value;if(r.type===l.array)return Ep(r,e,t);if(r.type===l.map)return _p(r,e,t);if(r.type===l.tag){if(t.tags&&typeof t.tags[r.value]=="function"){let n=mr(e,t);return t.tags[r.value](n)}throw new Error(`${D} tag not supported (${r.value})`)}throw new Error("unsupported")}function ti(e,t){if(!(e instanceof Uint8Array))throw new Error(`${D} data to decode must be a Uint8Array`);t=Object.assign({},Dp,t);let r=t.tokenizer||new ei(e,t),n=mr(r,t);if(n===pr)throw new Error(`${D} did not find any content to decode`);if(n===on)throw new Error(`${D} got unexpected break`);if(!r.done())throw new Error(`${D} too many terminals, data makes no sense`);return n}Me();var xc=42;function Ap(e){if(e.asCID!==e)return null;let t=g.asCID(e);if(!t)return null;let r=new Uint8Array(t.bytes.byteLength+1);return r.set(t.bytes,1),[new b(l.tag,xc),new b(l.bytes,r)]}function Cp(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function Tp(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}var kp={float64:!0,typeEncoders:{Object:Ap,undefined:Cp,number:Tp}};function Ip(e){if(e[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return g.decode(e.subarray(1))}var wc={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};wc.tags[xc]=Ip;var Op="dag-cbor",sn=113,at=e=>Qo(e,kp),Up=e=>ti(e,wc);function Bt(e){try{return e()}catch(t){return t}}Me();var ri=De(Jr(),1);nt();function ct(e){let t=ri.default.decode(e),r=ri.default.decode.bytes,n=e.subarray(r);return[t,n,r]}function Rp(e){return e===0||e===1}function ni(e){let[t,r]=ct(e);if(!Rp(t))throw new Error(`Unknown CID version ${t}`);let[n,o]=ct(r),[,i,s]=ct(o),[a,,c]=ct(i),u=o.subarray(0,s+c+a),d=o.subarray(s+c+a);return[g.create(t,n,zr(u)),d]}Me();Ct();function ut(e,t="StreamRef"){let[r,n]=ct(e);if(r!==206)throw new Error(`Invalid ${t}, does not include streamid codec`);let[o,i]=ct(n),s=ni(i),[a,c]=s;if(c.length===0)return{kind:"stream-id",type:o,genesis:a};if(c.length===1&&c[0]===0)return{kind:"commit-id",type:o,genesis:a,commit:null};{let[u]=ni(c);return{kind:"commit-id",type:o,genesis:a,commit:u}}}var Pp=/(ceramic:\/\/|\/ceramic\/)?([a-zA-Z0-9]+)(\?commit=([a-zA-Z0-9]+))?/;function Nt(e,t="StreamRef"){let r=Pp.exec(e)||[],n=r[2];if(!n)throw new Error(`Malformed ${t} string: ${e}`);let o=_e.decode(n),i=ut(o),s=r[4];return s?{kind:"commit-id",type:i.type,genesis:i.genesis,commit:oi(i.genesis,s)}:i}function Bp(e){try{return typeof e=="string"?g.parse(e):g.asCID(e)}catch{return null}}function oi(e,t=null){if(!t||t==="0")return null;let r=Bp(t);if(r)return e.equals(r)?null:r;throw new Error("Cannot specify commit as a number except to request commit 0 (the genesis commit)")}var br=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(i=(o<3?s(i):o>3?s(t,r,i):s(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},ge=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)},ai=class extends Error{constructor(t){super(`Invalid StreamID bytes ${_e.encode(t)}: contains commit`)}},ci=class extends Error{constructor(t){super(`Invalid StreamID string ${t}: contains commit`)}};function Dc(e){let t=ut(e,"StreamID");if(t.kind==="stream-id")return new E(t.type,t.genesis);throw new ai(e)}function Np(e){return Bt(()=>Dc(e))}function Ec(e){let t=Nt(e,"StreamID");if(t.kind==="stream-id")return new E(t.type,t.genesis);throw new ci(e)}function Mp(e){return Bt(()=>Ec(e))}var vc=Symbol.for("@ceramicnetwork/streamid/StreamID"),E=class{constructor(t,r){if(this._tag=vc,!(t||t===0))throw new Error("StreamID constructor: type required");if(!r)throw new Error("StreamID constructor: cid required");this._type=typeof t=="string"?ce.codeByName(t):t,this._cid=typeof r=="string"?g.parse(r):r}static isInstance(t){return typeof t=="object"&&"_tag"in t&&t._tag===vc}static async fromGenesis(t,r){let n=await pa({value:r,codec:hr,hasher:Uo});return new E(t,n.cid)}get type(){return this._type}get typeName(){return ce.nameByCode(this._type)}get cid(){return this._cid}get bytes(){let t=si.default.encode(206),r=si.default.encode(this.type);return Tt([t,r,this.cid.bytes])}get baseID(){return new E(this._type,this._cid)}equals(t){return E.isInstance(t)?this.type===t.type&&this.cid.equals(t.cid):!1}toString(){return _e.encode(this.bytes)}toUrl(){return`ceramic://${this.toString()}`}[Symbol.for("nodejs.util.inspect.custom")](){return`StreamID(${this.toString()})`}[Symbol.toPrimitive](){return this.toString()}};E.fromBytes=Dc;E.fromBytesNoThrow=Np;E.fromString=Ec;E.fromStringNoThrow=Mp;br([ue(),ge("design:type",String),ge("design:paramtypes",[])],E.prototype,"typeName",null);br([ue(),ge("design:type",Uint8Array),ge("design:paramtypes",[])],E.prototype,"bytes",null);br([ue(),ge("design:type",E),ge("design:paramtypes",[])],E.prototype,"baseID",null);br([ue(),ge("design:type",Function),ge("design:paramtypes",[]),ge("design:returntype",String)],E.prototype,"toString",null);br([ue(),ge("design:type",Function),ge("design:paramtypes",[]),ge("design:returntype",String)],E.prototype,"toUrl",null);var Ft=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(i=(o<3?s(i):o>3?s(t,r,i):s(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},ae=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)},ui=function(e,t,r,n,o){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?o.call(e,r):o?o.value=r:t.set(e,r),r},je=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},Mt,ft,yr,li=class extends Error{constructor(t){super(`Error while parsing CommitID from bytes ${_e.encode(t)}: no commit information provided`)}},di=class extends Error{constructor(t){super(`Error while parsing CommitID from string ${t}: no commit information provided`)}};function Sc(e){let t=ut(e,"CommitID");if(t.kind==="commit-id")return new P(t.type,t.genesis,t.commit);throw new li(e)}function Fp(e){return Bt(()=>Sc(e))}function Ac(e){let t=Nt(e,"CommitID");if(t.kind==="commit-id")return new P(t.type,t.genesis,t.commit);throw new di(e)}function Lp(e){return Bt(()=>Ac(e))}var _c=Symbol.for("@ceramicnetwork/streamid/CommitID");function jp(e,t){return new P(e.type,e.cid,t)}var P=class{constructor(t,r,n=null){if(this._tag=_c,Mt.set(this,void 0),ft.set(this,void 0),yr.set(this,void 0),!t&&t!==0)throw new Error("constructor: type required");if(!r)throw new Error("constructor: cid required");ui(this,Mt,typeof t=="string"?ce.codeByName(t):t,"f"),ui(this,ft,typeof r=="string"?g.parse(r):r,"f"),ui(this,yr,oi(je(this,ft,"f"),n),"f")}static isInstance(t){return typeof t=="object"&&"_tag"in t&&t._tag===_c}get baseID(){return new E(je(this,Mt,"f"),je(this,ft,"f"))}get type(){return je(this,Mt,"f")}get typeName(){return ce.nameByCode(je(this,Mt,"f"))}get cid(){return je(this,ft,"f")}get commit(){return je(this,yr,"f")||je(this,ft,"f")}get bytes(){let t=fi.default.encode(206),r=fi.default.encode(this.type),n=je(this,yr,"f")?.bytes||new Uint8Array([0]);return Tt([t,r,this.cid.bytes,n])}equals(t){return this.type===t.type&&this.cid.equals(t.cid)&&this.commit.equals(t.commit)}toString(){return _e.encode(this.bytes)}toUrl(){return`ceramic://${this.toString()}`}[(Mt=new WeakMap,ft=new WeakMap,yr=new WeakMap,Symbol.for("nodejs.util.inspect.custom"))](){return`CommitID(${this.toString()})`}[Symbol.toPrimitive](){return this.toString()}};P.fromBytes=Sc;P.fromBytesNoThrow=Fp;P.fromString=Ac;P.fromStringNoThrow=Lp;P.make=jp;Ft([ue(),ae("design:type",E),ae("design:paramtypes",[])],P.prototype,"baseID",null);Ft([ue(),ae("design:type",String),ae("design:paramtypes",[])],P.prototype,"typeName",null);Ft([ue(),ae("design:type",g),ae("design:paramtypes",[])],P.prototype,"commit",null);Ft([ue(),ae("design:type",Uint8Array),ae("design:paramtypes",[])],P.prototype,"bytes",null);Ft([ue(),ae("design:type",Function),ae("design:paramtypes",[]),ae("design:returntype",String)],P.prototype,"toString",null);Ft([ue(),ae("design:type",Function),ae("design:paramtypes",[]),ae("design:returntype",String)],P.prototype,"toUrl",null);Ct();var me;(function(e){function t(o){let i=ut(o);switch(i.kind){case"commit-id":return new P(i.type,i.genesis,i.commit);case"stream-id":return new E(i.type,i.genesis);default:throw new Error(`Malformed StreamRef bytes: ${_e.encode(o)}`)}}e.fromBytes=t;function r(o){let i=Nt(o);switch(i.kind){case"commit-id":return new P(i.type,i.genesis,i.commit);case"stream-id":return new E(i.type,i.genesis);default:throw new Error(`Malformed StreamRef string: ${o}`)}}e.fromString=r;function n(o){if(E.isInstance(o)||P.isInstance(o))return o;if(o instanceof Uint8Array)return t(o);if(typeof o=="string")return r(o);throw new Error(`Can not build CommitID or StreamID from ${JSON.stringify(o)}`)}e.from=n})(me||(me={}));function pi(e){return typeof e=="string"?E.fromString(e):e}function Cc(e,t){let r=new URL(e);for(let[n,o]of Object.entries(t))E.isInstance(o)?r.searchParams.set(n,o.toString()):typeof o=="object"?r.searchParams.set(n,JSON.stringify(o)):r.searchParams.set(n,o);return r}function mi(e){let t={};for(let[r,n]of Object.entries(e))E.isInstance(n)?t[r]=n.toString():t[r]=n;return t}var hi=function(e,t){return hi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},hi(e,t)};function ne(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");hi(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function Tc(e,t,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function a(d){try{u(n.next(d))}catch(w){s(w)}}function c(d){try{u(n.throw(d))}catch(w){s(w)}}function u(d){d.done?i(d.value):o(d.value).then(a,c)}u((n=n.apply(e,t||[])).next())})}function an(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(u){return function(d){return c([u,d])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,u[0]&&(r=0)),r;)try{if(n=1,o&&(i=u[0]&2?o.return:u[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,u[1])).done)return i;switch(o=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,o=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){r.label=u[1];break}if(u[0]===6&&r.label<i[1]){r.label=i[1],i=u;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(u);break}i[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r)}catch(d){u=[6,d],o=0}finally{n=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function $e(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function he(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],s;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(a){s={error:a}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return i}function Ce(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function lt(e){return this instanceof lt?(this.v=e,this):new lt(e)}function kc(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),o,i=[];return o={},s("next"),s("throw"),s("return"),o[Symbol.asyncIterator]=function(){return this},o;function s(x){n[x]&&(o[x]=function(h){return new Promise(function(y,v){i.push([x,h,y,v])>1||a(x,h)})})}function a(x,h){try{c(n[x](h))}catch(y){w(i[0][3],y)}}function c(x){x.value instanceof lt?Promise.resolve(x.value.v).then(u,d):w(i[0][2],x)}function u(x){a("next",x)}function d(x){a("throw",x)}function w(x,h){x(h),i.shift(),i.length&&a(i[0][0],i[0][1])}}function Ic(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof $e=="function"?$e(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=e[i]&&function(s){return new Promise(function(a,c){s=e[i](s),o(a,c,s.done,s.value)})}}function o(i,s,a,c){Promise.resolve(c).then(function(u){i({value:u,done:a})},s)}}function _(e){return typeof e=="function"}function Lt(e){var t=function(n){Error.call(n),n.stack=new Error().stack},r=e(t);return r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r}var cn=Lt(function(e){return function(r){e(this),this.message=r?r.length+` errors occurred during unsubscription:
`+r.map(function(n,o){return o+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=r}});function dt(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var Qe=function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,r,n,o,i;if(!this.closed){this.closed=!0;var s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var a=$e(s),c=a.next();!c.done;c=a.next()){var u=c.value;u.remove(this)}}catch(v){t={error:v}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}else s.remove(this);var d=this.initialTeardown;if(_(d))try{d()}catch(v){i=v instanceof cn?v.errors:[v]}var w=this._finalizers;if(w){this._finalizers=null;try{for(var x=$e(w),h=x.next();!h.done;h=x.next()){var y=h.value;try{Oc(y)}catch(v){i=i??[],v instanceof cn?i=Ce(Ce([],he(i)),he(v.errors)):i.push(v)}}}catch(v){n={error:v}}finally{try{h&&!h.done&&(o=x.return)&&o.call(x)}finally{if(n)throw n.error}}}if(i)throw new cn(i)}},e.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)Oc(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(r=this._finalizers)!==null&&r!==void 0?r:[]).push(t)}},e.prototype._hasParent=function(t){var r=this._parentage;return r===t||Array.isArray(r)&&r.includes(t)},e.prototype._addParent=function(t){var r=this._parentage;this._parentage=Array.isArray(r)?(r.push(t),r):r?[r,t]:t},e.prototype._removeParent=function(t){var r=this._parentage;r===t?this._parentage=null:Array.isArray(r)&&dt(r,t)},e.prototype.remove=function(t){var r=this._finalizers;r&&dt(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}();var bi=Qe.EMPTY;function un(e){return e instanceof Qe||e&&"closed"in e&&_(e.remove)&&_(e.add)&&_(e.unsubscribe)}function Oc(e){_(e)?e():e.unsubscribe()}var Te={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var jt={setTimeout:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var o=jt.delegate;return o?.setTimeout?o.setTimeout.apply(o,Ce([e,t],he(r))):setTimeout.apply(void 0,Ce([e,t],he(r)))},clearTimeout:function(e){var t=jt.delegate;return(t?.clearTimeout||clearTimeout)(e)},delegate:void 0};function fn(e){jt.setTimeout(function(){var t=Te.onUnhandledError;if(t)t(e);else throw e})}function yi(){}var Uc=function(){return xi("C",void 0,void 0)}();function Rc(e){return xi("E",void 0,e)}function Pc(e){return xi("N",e,void 0)}function xi(e,t,r){return{kind:e,value:t,error:r}}var pt=null;function $t(e){if(Te.useDeprecatedSynchronousErrorHandling){var t=!pt;if(t&&(pt={errorThrown:!1,error:null}),e(),t){var r=pt,n=r.errorThrown,o=r.error;if(pt=null,n)throw o}}else e()}function Bc(e){Te.useDeprecatedSynchronousErrorHandling&&pt&&(pt.errorThrown=!0,pt.error=e)}var xr=function(e){ne(t,e);function t(r){var n=e.call(this)||this;return n.isStopped=!1,r?(n.destination=r,un(r)&&r.add(n)):n.destination=Gp,n}return t.create=function(r,n,o){return new dn(r,n,o)},t.prototype.next=function(r){this.isStopped?gi(Pc(r),this):this._next(r)},t.prototype.error=function(r){this.isStopped?gi(Rc(r),this):(this.isStopped=!0,this._error(r))},t.prototype.complete=function(){this.isStopped?gi(Uc,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(r){this.destination.next(r)},t.prototype._error=function(r){try{this.destination.error(r)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(Qe);var $p=Function.prototype.bind;function wi(e,t){return $p.call(e,t)}var zp=function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var r=this.partialObserver;if(r.next)try{r.next(t)}catch(n){ln(n)}},e.prototype.error=function(t){var r=this.partialObserver;if(r.error)try{r.error(t)}catch(n){ln(n)}else ln(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(r){ln(r)}},e}(),dn=function(e){ne(t,e);function t(r,n,o){var i=e.call(this)||this,s;if(_(r)||!r)s={next:r??void 0,error:n??void 0,complete:o??void 0};else{var a;i&&Te.useDeprecatedNextContext?(a=Object.create(r),a.unsubscribe=function(){return i.unsubscribe()},s={next:r.next&&wi(r.next,a),error:r.error&&wi(r.error,a),complete:r.complete&&wi(r.complete,a)}):s=r}return i.destination=new zp(s),i}return t}(xr);function ln(e){Te.useDeprecatedSynchronousErrorHandling?Bc(e):fn(e)}function qp(e){throw e}function gi(e,t){var r=Te.onStoppedNotification;r&&jt.setTimeout(function(){return r(e,t)})}var Gp={closed:!0,next:yi,error:qp,complete:yi};var zt=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function qt(e){return e}function Nc(e){return e.length===0?qt:e.length===1?e[0]:function(r){return e.reduce(function(n,o){return o(n)},r)}}var B=function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(t,r,n){var o=this,i=Hp(t)?t:new dn(t,r,n);return $t(function(){var s=o,a=s.operator,c=s.source;i.add(a?a.call(i,c):c?o._subscribe(i):o._trySubscribe(i))}),i},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(r){t.error(r)}},e.prototype.forEach=function(t,r){var n=this;return r=Mc(r),new r(function(o,i){var s=new dn({next:function(a){try{t(a)}catch(c){i(c),s.unsubscribe()}},error:i,complete:o});n.subscribe(s)})},e.prototype._subscribe=function(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)},e.prototype[zt]=function(){return this},e.prototype.pipe=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Nc(t)(this)},e.prototype.toPromise=function(t){var r=this;return t=Mc(t),new t(function(n,o){var i;r.subscribe(function(s){return i=s},function(s){return o(s)},function(){return n(i)})})},e.create=function(t){return new e(t)},e}();function Mc(e){var t;return(t=e??Te.Promise)!==null&&t!==void 0?t:Promise}function Jp(e){return e&&_(e.next)&&_(e.error)&&_(e.complete)}function Hp(e){return e&&e instanceof xr||Jp(e)&&un(e)}function Vp(e){return _(e?.lift)}function W(e){return function(t){if(Vp(t))return t.lift(function(r){try{return e(r,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function Y(e,t,r,n,o){return new Wp(e,t,r,n,o)}var Wp=function(e){ne(t,e);function t(r,n,o,i,s,a){var c=e.call(this,r)||this;return c.onFinalize=s,c.shouldUnsubscribe=a,c._next=n?function(u){try{n(u)}catch(d){r.error(d)}}:e.prototype._next,c._error=i?function(u){try{i(u)}catch(d){r.error(d)}finally{this.unsubscribe()}}:e.prototype._error,c._complete=o?function(){try{o()}catch(u){r.error(u)}finally{this.unsubscribe()}}:e.prototype._complete,c}return t.prototype.unsubscribe=function(){var r;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&((r=this.onFinalize)===null||r===void 0||r.call(this))}},t}(xr);var Fc=Lt(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}});var vi=function(e){ne(t,e);function t(){var r=e.call(this)||this;return r.closed=!1,r.currentObservers=null,r.observers=[],r.isStopped=!1,r.hasError=!1,r.thrownError=null,r}return t.prototype.lift=function(r){var n=new Lc(this,this);return n.operator=r,n},t.prototype._throwIfClosed=function(){if(this.closed)throw new Fc},t.prototype.next=function(r){var n=this;$t(function(){var o,i;if(n._throwIfClosed(),!n.isStopped){n.currentObservers||(n.currentObservers=Array.from(n.observers));try{for(var s=$e(n.currentObservers),a=s.next();!a.done;a=s.next()){var c=a.value;c.next(r)}}catch(u){o={error:u}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}}})},t.prototype.error=function(r){var n=this;$t(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=r;for(var o=n.observers;o.length;)o.shift().error(r)}})},t.prototype.complete=function(){var r=this;$t(function(){if(r._throwIfClosed(),!r.isStopped){r.isStopped=!0;for(var n=r.observers;n.length;)n.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var r;return((r=this.observers)===null||r===void 0?void 0:r.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(r){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,r)},t.prototype._subscribe=function(r){return this._throwIfClosed(),this._checkFinalizedStatuses(r),this._innerSubscribe(r)},t.prototype._innerSubscribe=function(r){var n=this,o=this,i=o.hasError,s=o.isStopped,a=o.observers;return i||s?bi:(this.currentObservers=null,a.push(r),new Qe(function(){n.currentObservers=null,dt(a,r)}))},t.prototype._checkFinalizedStatuses=function(r){var n=this,o=n.hasError,i=n.thrownError,s=n.isStopped;o?r.error(i):s&&r.complete()},t.prototype.asObservable=function(){var r=new B;return r.source=this,r},t.create=function(r,n){return new Lc(r,n)},t}(B);var Lc=function(e){ne(t,e);function t(r,n){var o=e.call(this)||this;return o.destination=r,o.source=n,o}return t.prototype.next=function(r){var n,o;(o=(n=this.destination)===null||n===void 0?void 0:n.next)===null||o===void 0||o.call(n,r)},t.prototype.error=function(r){var n,o;(o=(n=this.destination)===null||n===void 0?void 0:n.error)===null||o===void 0||o.call(n,r)},t.prototype.complete=function(){var r,n;(n=(r=this.destination)===null||r===void 0?void 0:r.complete)===null||n===void 0||n.call(r)},t.prototype._subscribe=function(r){var n,o;return(o=(n=this.source)===null||n===void 0?void 0:n.subscribe(r))!==null&&o!==void 0?o:bi},t}(vi);var Di=function(e){ne(t,e);function t(r){var n=e.call(this)||this;return n._value=r,n}return Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(r){var n=e.prototype._subscribe.call(this,r);return!n.closed&&r.next(this._value),n},t.prototype.getValue=function(){var r=this,n=r.hasError,o=r.thrownError,i=r._value;if(n)throw o;return this._throwIfClosed(),i},t.prototype.next=function(r){e.prototype.next.call(this,this._value=r)},t}(vi);var Ei={now:function(){return(Ei.delegate||Date).now()},delegate:void 0};var jc=function(e){ne(t,e);function t(r,n){return e.call(this)||this}return t.prototype.schedule=function(r,n){return n===void 0&&(n=0),this},t}(Qe);var wr={setInterval:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var o=wr.delegate;return o?.setInterval?o.setInterval.apply(o,Ce([e,t],he(r))):setInterval.apply(void 0,Ce([e,t],he(r)))},clearInterval:function(e){var t=wr.delegate;return(t?.clearInterval||clearInterval)(e)},delegate:void 0};var $c=function(e){ne(t,e);function t(r,n){var o=e.call(this,r,n)||this;return o.scheduler=r,o.work=n,o.pending=!1,o}return t.prototype.schedule=function(r,n){var o;if(n===void 0&&(n=0),this.closed)return this;this.state=r;var i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=(o=this.id)!==null&&o!==void 0?o:this.requestAsyncId(s,this.id,n),this},t.prototype.requestAsyncId=function(r,n,o){return o===void 0&&(o=0),wr.setInterval(r.flush.bind(r,this),o)},t.prototype.recycleAsyncId=function(r,n,o){if(o===void 0&&(o=0),o!=null&&this.delay===o&&this.pending===!1)return n;n!=null&&wr.clearInterval(n)},t.prototype.execute=function(r,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var o=this._execute(r,n);if(o)return o;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(r,n){var o=!1,i;try{this.work(r)}catch(s){o=!0,i=s||new Error("Scheduled action threw falsy error")}if(o)return this.unsubscribe(),i},t.prototype.unsubscribe=function(){if(!this.closed){var r=this,n=r.id,o=r.scheduler,i=o.actions;this.work=this.state=this.scheduler=null,this.pending=!1,dt(i,this),n!=null&&(this.id=this.recycleAsyncId(o,n,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(jc);var _i=function(){function e(t,r){r===void 0&&(r=e.now),this.schedulerActionCtor=t,this.now=r}return e.prototype.schedule=function(t,r,n){return r===void 0&&(r=0),new this.schedulerActionCtor(this,t).schedule(n,r)},e.now=Ei.now,e}();var zc=function(e){ne(t,e);function t(r,n){n===void 0&&(n=_i.now);var o=e.call(this,r,n)||this;return o.actions=[],o._active=!1,o}return t.prototype.flush=function(r){var n=this.actions;if(this._active){n.push(r);return}var o;this._active=!0;do if(o=r.execute(r.state,r.delay))break;while(r=n.shift());if(this._active=!1,o){for(;r=n.shift();)r.unsubscribe();throw o}},t}(_i);var Yp=new zc($c),qc=Yp;var pn=new B(function(e){return e.complete()});function mn(e){return e&&_(e.schedule)}function Gc(e){return e[e.length-1]}function Jc(e){return mn(Gc(e))?e.pop():void 0}function Hc(e,t){return typeof Gc(e)=="number"?e.pop():t}var Gt=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function hn(e){return _(e?.then)}function bn(e){return _(e[zt])}function yn(e){return Symbol.asyncIterator&&_(e?.[Symbol.asyncIterator])}function xn(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Kp(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var wn=Kp();function gn(e){return _(e?.[wn])}function vn(e){return kc(this,arguments,function(){var r,n,o,i;return an(this,function(s){switch(s.label){case 0:r=e.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,lt(r.read())];case 3:return n=s.sent(),o=n.value,i=n.done,i?[4,lt(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return[4,lt(o)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return r.releaseLock(),[7];case 10:return[2]}})})}function Dn(e){return _(e?.getReader)}function oe(e){if(e instanceof B)return e;if(e!=null){if(bn(e))return Xp(e);if(Gt(e))return Zp(e);if(hn(e))return Qp(e);if(yn(e))return Vc(e);if(gn(e))return em(e);if(Dn(e))return tm(e)}throw xn(e)}function Xp(e){return new B(function(t){var r=e[zt]();if(_(r.subscribe))return r.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Zp(e){return new B(function(t){for(var r=0;r<e.length&&!t.closed;r++)t.next(e[r]);t.complete()})}function Qp(e){return new B(function(t){e.then(function(r){t.closed||(t.next(r),t.complete())},function(r){return t.error(r)}).then(null,fn)})}function em(e){return new B(function(t){var r,n;try{for(var o=$e(e),i=o.next();!i.done;i=o.next()){var s=i.value;if(t.next(s),t.closed)return}}catch(a){r={error:a}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}t.complete()})}function Vc(e){return new B(function(t){rm(e,t).catch(function(r){return t.error(r)})})}function tm(e){return Vc(vn(e))}function rm(e,t){var r,n,o,i;return Tc(this,void 0,void 0,function(){var s,a;return an(this,function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),r=Ic(e),c.label=1;case 1:return[4,r.next()];case 2:if(n=c.sent(),!!n.done)return[3,4];if(s=n.value,t.next(s),t.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=c.sent(),o={error:a},[3,11];case 6:return c.trys.push([6,,9,10]),n&&!n.done&&(i=r.return)?[4,i.call(r)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function ve(e,t,r,n,o){n===void 0&&(n=0),o===void 0&&(o=!1);var i=t.schedule(function(){r(),o?e.add(this.schedule(null,n)):this.unsubscribe()},n);if(e.add(i),!o)return i}function En(e,t){return t===void 0&&(t=0),W(function(r,n){r.subscribe(Y(n,function(o){return ve(n,e,function(){return n.next(o)},t)},function(){return ve(n,e,function(){return n.complete()},t)},function(o){return ve(n,e,function(){return n.error(o)},t)}))})}function _n(e,t){return t===void 0&&(t=0),W(function(r,n){n.add(e.schedule(function(){return r.subscribe(n)},t))})}function Wc(e,t){return oe(e).pipe(_n(t),En(t))}function Yc(e,t){return oe(e).pipe(_n(t),En(t))}function Kc(e,t){return new B(function(r){var n=0;return t.schedule(function(){n===e.length?r.complete():(r.next(e[n++]),r.closed||this.schedule())})})}function Xc(e,t){return new B(function(r){var n;return ve(r,t,function(){n=e[wn](),ve(r,t,function(){var o,i,s;try{o=n.next(),i=o.value,s=o.done}catch(a){r.error(a);return}s?r.complete():r.next(i)},0,!0)}),function(){return _(n?.return)&&n.return()}})}function Sn(e,t){if(!e)throw new Error("Iterable cannot be null");return new B(function(r){ve(r,t,function(){var n=e[Symbol.asyncIterator]();ve(r,t,function(){n.next().then(function(o){o.done?r.complete():r.next(o.value)})},0,!0)})})}function Zc(e,t){return Sn(vn(e),t)}function Qc(e,t){if(e!=null){if(bn(e))return Wc(e,t);if(Gt(e))return Kc(e,t);if(hn(e))return Yc(e,t);if(yn(e))return Sn(e,t);if(gn(e))return Xc(e,t);if(Dn(e))return Zc(e,t)}throw xn(e)}function eu(e,t){return t?Qc(e,t):oe(e)}var An=Lt(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});function tu(e){return e instanceof Date&&!isNaN(e)}function Cn(e,t){return W(function(r,n){var o=0;r.subscribe(Y(n,function(i){n.next(e.call(t,i,o++))}))})}var nm=Array.isArray;function om(e,t){return nm(t)?e.apply(void 0,Ce([],he(t))):e(t)}function ru(e){return Cn(function(t){return om(e,t)})}function nu(e,t,r,n,o,i,s,a){var c=[],u=0,d=0,w=!1,x=function(){w&&!c.length&&!u&&t.complete()},h=function(v){return u<n?y(v):c.push(v)},y=function(v){i&&t.next(v),u++;var L=!1;oe(r(v,d++)).subscribe(Y(t,function(k){o?.(k),i?h(k):t.next(k)},function(){L=!0},void 0,function(){if(L)try{u--;for(var k=function(){var U=c.shift();s?ve(t,s,function(){return y(U)}):y(U)};c.length&&u<n;)k();x()}catch(U){t.error(U)}}))};return e.subscribe(Y(t,h,function(){w=!0,x()})),function(){a?.()}}function gr(e,t,r){return r===void 0&&(r=1/0),_(t)?gr(function(n,o){return Cn(function(i,s){return t(n,i,o,s)})(oe(e(n,o)))},r):(typeof t=="number"&&(r=t),W(function(n,o){return nu(n,o,e,r)}))}function ou(e){return e===void 0&&(e=1/0),gr(qt,e)}var im=["addListener","removeListener"],sm=["addEventListener","removeEventListener"],am=["on","off"];function vr(e,t,r,n){if(_(r)&&(n=r,r=void 0),n)return vr(e,t,r).pipe(ru(n));var o=he(fm(e)?sm.map(function(a){return function(c){return e[a](t,c,r)}}):cm(e)?im.map(iu(e,t)):um(e)?am.map(iu(e,t)):[],2),i=o[0],s=o[1];if(!i&&Gt(e))return gr(function(a){return vr(a,t,r)})(oe(e));if(!i)throw new TypeError("Invalid event target");return new B(function(a){var c=function(){for(var u=[],d=0;d<arguments.length;d++)u[d]=arguments[d];return a.next(1<u.length?u:u[0])};return i(c),function(){return s(c)}})}function iu(e,t){return function(r){return function(n){return e[r](t,n)}}}function cm(e){return _(e.addListener)&&_(e.removeListener)}function um(e){return _(e.on)&&_(e.off)}function fm(e){return _(e.addEventListener)&&_(e.removeEventListener)}function Dr(e,t,r){e===void 0&&(e=0),r===void 0&&(r=qc);var n=-1;return t!=null&&(mn(t)?r=t:n=t),new B(function(o){var i=tu(e)?+e-r.now():e;i<0&&(i=0);var s=0;return r.schedule(function(){o.closed||(o.next(s++),0<=n?this.schedule(void 0,n):o.complete())},i)})}function Si(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Jc(e),n=Hc(e,1/0),o=e;return o.length?o.length===1?oe(o[0]):ou(n)(eu(o,r)):pn}function su(e,t){return W(function(r,n){var o=0;r.subscribe(Y(n,function(i){return e.call(t,i,o++)&&n.next(i)}))})}function au(e){return W(function(t,r){var n=!1;t.subscribe(Y(r,function(o){n=!0,r.next(o)},function(){n||r.next(e),r.complete()}))})}function cu(e){return e<=0?function(){return pn}:W(function(t,r){var n=0;t.subscribe(Y(r,function(o){++n<=e&&(r.next(o),e<=n&&r.complete())}))})}function uu(e){return e===void 0&&(e=lm),W(function(t,r){var n=!1;t.subscribe(Y(r,function(o){n=!0,r.next(o)},function(){return n?r.complete():r.error(e())}))})}function lm(){return new An}function Ai(e,t){var r=arguments.length>=2;return function(n){return n.pipe(e?su(function(o,i){return e(o,i,n)}):qt,cu(1),r?au(t):uu(function(){return new An}))}}var dm={leading:!0,trailing:!1};function Ci(e,t){return t===void 0&&(t=dm),W(function(r,n){var o=t.leading,i=t.trailing,s=!1,a=null,c=null,u=!1,d=function(){c?.unsubscribe(),c=null,i&&(h(),u&&n.complete())},w=function(){c=null,u&&n.complete()},x=function(y){return c=oe(e(y)).subscribe(Y(n,d,w))},h=function(){if(s){s=!1;var y=a;a=null,n.next(y),!u&&x(y)}};r.subscribe(Y(n,function(y){s=!0,a=y,!(c&&!c.closed)&&(o?h():x(y))},function(){u=!0,!(i&&s&&c&&!c.closed)&&n.complete()}))})}var $;(function(e){e[e.PREFER_CACHE=0]="PREFER_CACHE",e[e.SYNC_ALWAYS=1]="SYNC_ALWAYS",e[e.NEVER_SYNC=2]="NEVER_SYNC"})($||($={}));var zi=De(Ar(),1);var Xu;(function(e){e[e.GENESIS=0]="GENESIS",e[e.PARTIAL=1]="PARTIAL",e[e.SIGNED=2]="SIGNED"})(Xu||(Xu={}));var Cr;(function(e){e[e.NOT_REQUESTED=0]="NOT_REQUESTED",e[e.PENDING=1]="PENDING",e[e.PROCESSING=2]="PROCESSING",e[e.ANCHORED=3]="ANCHORED",e[e.FAILED=4]="FAILED"})(Cr||(Cr={}));var qi;(function(e){e[e.GENESIS=0]="GENESIS",e[e.SIGNED=1]="SIGNED",e[e.ANCHOR=2]="ANCHOR"})(qi||(qi={}));var Ue=class extends B{constructor(t,r){super(n=>{t.subscribe(n)}),this.state$=t,this._context=r}get id(){return new E(this.state$.value.type,this.state$.value.log[0].cid)}get api(){return this._context.api}get content(){let{next:t,content:r}=this.state$.value;return(0,zi.default)(t?.content??r)}get tip(){return this.state$.value.log[this.state$.value.log.length-1].cid}get commitId(){return P.make(this.id,this.tip)}get allCommitIds(){return this.state$.value.log.map(({cid:t})=>P.make(this.id,t))}get anchorCommitIds(){return this.state$.value.log.filter(({type:t})=>t===qi.ANCHOR).map(({cid:t})=>P.make(this.id,t))}get state(){return(0,zi.default)(this.state$.value)}async sync(t={}){t={sync:$.PREFER_CACHE,...t};let r=await this.api.loadStream(this.id,t);this.state$.next(r.state)}async requestAnchor(){return this.api.requestAnchor(this.id)}};function tt(){return e=>{}}var nf=De(ef(),1);function tf(e){let t=new AbortController;if(e.length===0)throw Error("Need abort signals to create a merged abort signal");return e.some(r=>r.aborted)?(t.abort(),t.signal):(Si(...e.map(r=>vr(r,"abort"))).pipe(Ai()).subscribe(()=>{t.abort()}),t.signal)}var Mn=class{constructor(t){let r=new AbortController;if(this.signal=r.signal,t<=0){r.abort();return}this._subscription=Dr(t).subscribe(()=>{r.abort()})}clear(){this._subscription?.unsubscribe()}};async function rf(e,t){let r=new AbortController,n=()=>{r.abort()};return e.addEventListener("abort",n),e.aborted&&r.abort(),t(r.signal).finally(()=>{e.removeEventListener("abort",n)})}var jh=60*1e3*3;async function Z(e,t={}){t.body&&Object.assign(t,{body:JSON.stringify(t.body),headers:{...t.headers,"Content-Type":"application/json"}});let r=t.timeout||jh,n=new Mn(r),o=t.signal?tf([t.signal,n.signal]):n.signal,i=await rf(o,s=>(0,nf.default)(String(e),{...t,signal:s})).finally(()=>n.clear());if(!i.ok){let s=await i.text();throw new Error(`HTTP request to '${e}' failed with status '${i.statusText}': ${s}`)}return i.json()}var Tr=De(Ar(),1);Me();function Je(e){let t=g.asCID(e);if(t)return t;if(typeof e=="string")return g.parse(e);if(e instanceof Uint8Array)return g.decode(e);throw new Error(`${e} cannot be converted to a CID`)}var of=0,N=class{static streamIdFromState(t){return new E(t.type,t.log[0].cid)}static serializeCommit(t){let r=(0,Tr.default)(t);return N.isSignedCommitContainer(r)?(r.jws.link=r.jws.link.toString(),r.linkedBlock=Fe(r.linkedBlock,"base64"),r.cacaoBlock&&(r.cacaoBlock=Fe(r.cacaoBlock,"base64")),r):(N.isSignedCommit(t)&&(r.link=r.link.toString()),N.isAnchorCommit(t)&&(r.proof=r.proof.toString()),r.id&&(r.id=r.id.toString()),r.prev&&(r.prev=r.prev.toString()),t.header?.model&&(r.header.model=Fe(t.header.model,"base64")),r)}static deserializeCommit(t){let r=(0,Tr.default)(t);return N.isSignedCommitContainer(r)?(r.jws.link=Je(r.jws.link),r.linkedBlock=it(r.linkedBlock,"base64"),r.cacaoBlock&&(r.cacaoBlock=it(r.cacaoBlock,"base64")),r):(N.isSignedCommit(r)&&(r.link=Je(r.link)),N.isAnchorCommit(r)&&(r.proof=Je(r.proof)),r.id&&(r.id=Je(r.id)),r.prev&&(r.prev=Je(r.prev)),r.header?.model&&(r.header.model=it(r.header.model,"base64")),r)}static serializeState(t){let r=(0,Tr.default)(t);return r.log=r.log.map(n=>({...n,cid:n.cid.toString()})),r.anchorStatus!=null&&(r.anchorStatus=Cr[r.anchorStatus]),r.anchorProof!=null&&(r.anchorProof.txHash=r.anchorProof.txHash.toString(),r.anchorProof.root=r.anchorProof.root.toString()),t.metadata?.model&&(r.metadata.model=t.metadata.model.toString()),t.next?.metadata?.model&&(r.next.metadata.model=t.next.metadata.model.toString()),t.metadata?.unique&&t.type!=of&&(r.metadata.unique=Fe(r.metadata.unique,"base64")),r.doctype=ce.nameByCode(r.type),r}static deserializeState(t){if(!t)return null;let r=(0,Tr.default)(t);return r.doctype&&(r.type=ce.codeByName(r.doctype),delete r.doctype),r.log=r.log.map(n=>({...n,cid:Je(n.cid)})),r.anchorProof&&(r.anchorProof.txHash=Je(r.anchorProof.txHash),r.anchorProof.root=Je(r.anchorProof.root)),r.anchorStatus&&(r.anchorStatus=Cr[r.anchorStatus]),t.metadata?.model&&(r.metadata.model=E.fromString(t.metadata.model)),t.next?.metadata?.model&&(r.next.metadata.model=E.fromString(t.next.metadata.model)),t.metadata?.unique&&t.type!=of&&(r.metadata.unique=it(t.metadata.unique,"base64")),r}static statesEqual(t,r){return JSON.stringify(N.serializeState(t))===JSON.stringify(N.serializeState(r))}static isStateSupersetOf(t,r){if(t.log.length<r.log.length)return!1;for(let n in r.log)if(!t.log[n].cid.equals(r.log[n].cid))return!1;return!(t.log.length===r.log.length&&t.anchorStatus!=r.anchorStatus)}static assertCommitLinksToState(t,r){let n=this.streamIdFromState(t);if(r.id&&!r.id.equals(t.log[0].cid))throw new Error(`Invalid genesis CID in commit for StreamID ${n.toString()}. Found: ${r.id}, expected ${t.log[0].cid}`);let o=t.log[t.log.length-1].cid;if(!r.prev.equals(o))throw new Error(`Commit doesn't properly point to previous commit in log. Expected ${o}, found 'prev' ${r.prev}`)}static async convertCommitToSignedCommitContainer(t,r){if(N.isSignedCommit(t)){let n=await r.block.get(t.link);return{jws:t,linkedBlock:n}}return t}static isSignedCommitContainer(t){return t&&t.jws!==void 0}static isSignedCommit(t){return t&&t.link!==void 0}static isAnchorCommit(t){return t&&t.proof!==void 0}static isSignedCommitData(t){return t&&t.envelope!==void 0}static isAnchorCommitData(t){return t&&t.proof!==void 0}static commitDataToLogEntry(t,r){let n={cid:t.cid,type:r};return t?.capability?.p?.exp&&(n.expirationTime=Math.floor(Date.parse(t.capability.p.exp)/1e3)),t.timestamp&&(n.timestamp=t.timestamp),n}static checkForCacaoExpiration(t){let r=Math.floor(Date.now()/1e3);for(let n of t.log){let o=n.timestamp??r;if(n.expirationTime&&n.expirationTime<o)throw new Error(`CACAO expired: Commit ${n.cid.toString()} of Stream ${N.streamIdFromState(t).toString()} has a CACAO that expired at ${n.expirationTime}. Loading the stream with 'sync: SyncOptions.ALWAYS_SYNC' will restore the stream to a usable state, by discarding the invalid commits (this means losing the data from those invalid writes!)`)}}};function ts(){return ts=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ts.apply(this,arguments)}var rs={name:"chainId",regex:"[-:a-zA-Z0-9]{5,41}",parameters:{delimiter:":",values:{0:{name:"namespace",regex:"[-a-z0-9]{3,8}"},1:{name:"reference",regex:"[-a-zA-Z0-9]{1,32}"}}}},vb={name:"accountId",regex:"[-:a-zA-Z0-9]{7,106}",parameters:{delimiter:":",values:{0:{name:"namespace",regex:"[-a-z0-9]{3,8}"},1:{name:"reference",regex:"[-a-zA-Z0-9]{1,32}"},2:{name:"address",regex:"[a-zA-Z0-9]{1,64}"}}}},ns={name:"assetName",regex:"[-:a-zA-Z0-9]{5,73}",parameters:{delimiter:":",values:{0:{name:"namespace",regex:"[-a-z0-9]{3,8}"},1:{name:"reference",regex:"[-a-zA-Z0-9]{1,64}"}}}},Db={name:"assetType",regex:"[-:a-zA-Z0-9]{11,115}",parameters:{delimiter:"/",values:{0:rs,1:ns}}},Eb={name:"assetId",regex:"[-:a-zA-Z0-9]{13,148}",parameters:{delimiter:"/",values:{0:rs,1:ns,2:{name:"tokenId",regex:"[-a-zA-Z0-9]{1,32}"}}}},kr={2:rs,10:vb,19:{assetName:ns,assetType:Db,assetId:Eb}};function vf(e,t){return e.split(t.parameters.delimiter)}function Ir(e,t){var r=vf(e,t),n={};return r.forEach(function(o,i){n[t.parameters.values[i].name]=o}),n}function Xt(e,t){return Object.values(t.parameters.values).map(function(r){var n=e[r.name];return typeof n=="string"?n:Xt(n,r)}).join(t.parameters.delimiter)}function Or(e,t){if(!new RegExp(t.regex).test(e))return!1;var r=vf(e,t);if(r.length!==Object.keys(t.parameters.values).length)return!1;var n=r.map(function(o,i){return new RegExp(t.parameters.values[i].regex).test(o)}).filter(function(o){return!!o});return n.length===r.length}var Kt=function(){function e(r){typeof r=="string"&&(r=e.parse(r)),this.namespace=r.namespace,this.reference=r.reference}e.parse=function(n){if(!Or(n,this.spec))throw new Error("Invalid "+this.spec.name+" provided: "+n);return new e(Ir(n,this.spec)).toJSON()},e.format=function(n){return Xt(n,this.spec)};var t=e.prototype;return t.toString=function(){return e.format(this.toJSON())},t.toJSON=function(){return{namespace:this.namespace,reference:this.reference}},e}();Kt.spec=kr[2];var qn=function(){function e(r){typeof r=="string"&&(r=e.parse(r)),this.chainId=new Kt(r.chainId),this.address=r.address}e.parse=function(n){if(!Or(n,this.spec))throw new Error("Invalid "+this.spec.name+" provided: "+n);var o=Ir(n,this.spec),i=o.namespace,s=o.reference,a=o.address,c=new Kt({namespace:i,reference:s});return new e({chainId:c,address:a}).toJSON()},e.format=function(n){var o=new Kt(n.chainId),i=ts({},o.toJSON(),{address:n.address});return Xt(i,this.spec)};var t=e.prototype;return t.toString=function(){return e.format(this.toJSON())},t.toJSON=function(){return{chainId:this.chainId.toJSON(),address:this.address}},e}();qn.spec=kr[10];var os=function(){function e(r){typeof r=="string"&&(r=e.parse(r)),this.namespace=r.namespace,this.reference=r.reference}e.parse=function(n){if(!Or(n,this.spec))throw new Error("Invalid "+this.spec.name+" provided: "+n);return new e(Ir(n,this.spec)).toJSON()},e.format=function(n){return Xt(n,this.spec)};var t=e.prototype;return t.toString=function(){return e.format(this.toJSON())},t.toJSON=function(){return{namespace:this.namespace,reference:this.reference}},e}();os.spec=kr[19].assetName;var _b=function(){function e(r){typeof r=="string"&&(r=e.parse(r)),this.chainId=new Kt(r.chainId),this.assetName=new os(r.assetName)}e.parse=function(n){if(!Or(n,this.spec))throw new Error("Invalid "+this.spec.name+" provided: "+n);return new e(Ir(n,this.spec)).toJSON()},e.format=function(n){return Xt(n,this.spec)};var t=e.prototype;return t.toString=function(){return e.format(this.toJSON())},t.toJSON=function(){return{chainId:this.chainId.toJSON(),assetName:this.assetName}},e}();_b.spec=kr[19].assetType;var Sb=function(){function e(r){typeof r=="string"&&(r=e.parse(r)),this.chainId=new Kt(r.chainId),this.assetName=new os(r.assetName),this.tokenId=r.tokenId}e.parse=function(n){if(!Or(n,this.spec))throw new Error("Invalid "+this.spec.name+" provided: "+n);return new e(Ir(n,this.spec)).toJSON()},e.format=function(n){return Xt(n,this.spec)};var t=e.prototype;return t.toString=function(){return e.format(this.toJSON())},t.toJSON=function(){return{chainId:this.chainId.toJSON(),assetName:this.assetName.toJSON(),tokenId:this.tokenId}},e}();Sb.spec=kr[19].assetId;function Df(e){if(typeof e=="string"&&e.includes("@")){let[t,r]=e.split("@");if(!t||!r)throw new Error("Invalid accountId provided");return new qn({address:t,chainId:r})}return new qn(e)}var Gn=class extends Di{next(t){let r=this.value;N.statesEqual(r,t)||super.next(t)}};var se=class extends B{constructor(t,r,n){super(o=>{this.state$.observers.length===0&&(this.periodicSubscription=Dr(0,n).pipe(Ci(()=>this._syncState(this.id,{sync:$.PREFER_CACHE}))).subscribe()),this.state$.subscribe(o).add(()=>{this.state$.observers.length===0&&this.periodicSubscription?.unsubscribe()})}),this.state$=new Gn(t),this._apiUrl=new URL(r)}get value(){return this.state$.value}get state(){return this.state$.value}next(t){this.state$.next(t)}async _syncState(t,r){let n=await se._load(t,this._apiUrl,r);this.state$.next(N.deserializeState(n))}get id(){return new E(this.state$.value.type,this.state$.value.log[0].cid)}static async createFromGenesis(t,r,n,o,i){let s=new URL("./streams",t),{state:a}=await Z(s,{method:"post",body:{type:r,genesis:N.serializeCommit(n),opts:o}});return new se(N.deserializeState(a),t,i)}static async applyCommit(t,r,n,o,i){let s=new URL("./commits",t),{state:a}=await Z(s,{method:"post",body:{streamId:r.toString(),commit:N.serializeCommit(n),opts:o}});return new se(N.deserializeState(a),t,i)}static async _load(t,r,n){let o=Cc(new URL(`./streams/${t}`,r),n),{state:i}=await Z(o);return i}static async load(t,r,n,o){let i=await se._load(t,r,o);return new se(N.deserializeState(i),r,n)}static async loadStreamCommits(t,r){let n=new URL(`./commits/${t}`,r),{commits:o}=await Z(n);return o.map(i=>({cid:i.cid,value:N.deserializeCommit(i.value)}))}complete(){this.state$.complete()}};var is={};H(is,{JsonPatchError:()=>G,_areEquals:()=>Pr,applyOperation:()=>yt,applyPatch:()=>Xn,applyReducer:()=>Ib,deepClone:()=>Tb,getValueByPointer:()=>Yn,validate:()=>_f,validator:()=>Kn});var Ab=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Cb=Object.prototype.hasOwnProperty;function Hn(e,t){return Cb.call(e,t)}function Vn(e){if(Array.isArray(e)){for(var t=new Array(e.length),r=0;r<t.length;r++)t[r]=""+r;return t}if(Object.keys)return Object.keys(e);var n=[];for(var o in e)Hn(e,o)&&n.push(o);return n}function Q(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function Wn(e){for(var t=0,r=e.length,n;t<r;){if(n=e.charCodeAt(t),n>=48&&n<=57){t++;continue}return!1}return!0}function Re(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function Ur(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function Jn(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,r=e.length;t<r;t++)if(Jn(e[t]))return!0}else if(typeof e=="object"){for(var n=Vn(e),o=n.length,i=0;i<o;i++)if(Jn(e[n[i]]))return!0}}return!1}function Ef(e,t){var r=[e];for(var n in t){var o=typeof t[n]=="object"?JSON.stringify(t[n],null,2):t[n];typeof o<"u"&&r.push(n+": "+o)}return r.join(`
`)}var Rr=function(e){Ab(t,e);function t(r,n,o,i,s){var a=this.constructor,c=e.call(this,Ef(r,{name:n,index:o,operation:i,tree:s}))||this;return c.name=n,c.index=o,c.operation=i,c.tree=s,Object.setPrototypeOf(c,a.prototype),c.message=Ef(r,{name:n,index:o,operation:i,tree:s}),c}return t}(Error);var G=Rr,Tb=Q,Zt={add:function(e,t,r){return e[t]=this.value,{newDocument:r}},remove:function(e,t,r){var n=e[t];return delete e[t],{newDocument:r,removed:n}},replace:function(e,t,r){var n=e[t];return e[t]=this.value,{newDocument:r,removed:n}},move:function(e,t,r){var n=Yn(r,this.path);n&&(n=Q(n));var o=yt(r,{op:"remove",path:this.from}).removed;return yt(r,{op:"add",path:this.path,value:o}),{newDocument:r,removed:n}},copy:function(e,t,r){var n=Yn(r,this.from);return yt(r,{op:"add",path:this.path,value:Q(n)}),{newDocument:r}},test:function(e,t,r){return{newDocument:r,test:Pr(e[t],this.value)}},_get:function(e,t,r){return this.value=e[t],{newDocument:r}}},kb={add:function(e,t,r){return Wn(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:r,index:t}},remove:function(e,t,r){var n=e.splice(t,1);return{newDocument:r,removed:n[0]}},replace:function(e,t,r){var n=e[t];return e[t]=this.value,{newDocument:r,removed:n}},move:Zt.move,copy:Zt.copy,test:Zt.test,_get:Zt._get};function Yn(e,t){if(t=="")return e;var r={op:"_get",path:t};return yt(e,r),r.value}function yt(e,t,r,n,o,i){if(r===void 0&&(r=!1),n===void 0&&(n=!0),o===void 0&&(o=!0),i===void 0&&(i=0),r&&(typeof r=="function"?r(t,0,e,t.path):Kn(t,0)),t.path===""){var s={newDocument:e};if(t.op==="add")return s.newDocument=t.value,s;if(t.op==="replace")return s.newDocument=t.value,s.removed=e,s;if(t.op==="move"||t.op==="copy")return s.newDocument=Yn(e,t.from),t.op==="move"&&(s.removed=e),s;if(t.op==="test"){if(s.test=Pr(e,t.value),s.test===!1)throw new G("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return s.newDocument=e,s}else{if(t.op==="remove")return s.removed=e,s.newDocument=null,s;if(t.op==="_get")return t.value=e,s;if(r)throw new G("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",i,t,e);return s}}else{n||(e=Q(e));var a=t.path||"",c=a.split("/"),u=e,d=1,w=c.length,x=void 0,h=void 0,y=void 0;for(typeof r=="function"?y=r:y=Kn;;){if(h=c[d],h&&h.indexOf("~")!=-1&&(h=Ur(h)),o&&(h=="__proto__"||h=="prototype"&&d>0&&c[d-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(r&&x===void 0&&(u[h]===void 0?x=c.slice(0,d).join("/"):d==w-1&&(x=t.path),x!==void 0&&y(t,0,e,x)),d++,Array.isArray(u)){if(h==="-")h=u.length;else{if(r&&!Wn(h))throw new G("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",i,t,e);Wn(h)&&(h=~~h)}if(d>=w){if(r&&t.op==="add"&&h>u.length)throw new G("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",i,t,e);var s=kb[t.op].call(t,u,h,e);if(s.test===!1)throw new G("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return s}}else if(d>=w){var s=Zt[t.op].call(t,u,h,e);if(s.test===!1)throw new G("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return s}if(u=u[h],r&&d<w&&(!u||typeof u!="object"))throw new G("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",i,t,e)}}}function Xn(e,t,r,n,o){if(n===void 0&&(n=!0),o===void 0&&(o=!0),r&&!Array.isArray(t))throw new G("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");n||(e=Q(e));for(var i=new Array(t.length),s=0,a=t.length;s<a;s++)i[s]=yt(e,t[s],r,!0,o,s),e=i[s].newDocument;return i.newDocument=e,i}function Ib(e,t,r){var n=yt(e,t);if(n.test===!1)throw new G("Test operation failed","TEST_OPERATION_FAILED",r,t,e);return n.newDocument}function Kn(e,t,r,n){if(typeof e!="object"||e===null||Array.isArray(e))throw new G("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,r);if(Zt[e.op]){if(typeof e.path!="string")throw new G("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,r);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new G('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,r);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new G("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,r);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new G("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,r);if((e.op==="add"||e.op==="replace"||e.op==="test")&&Jn(e.value))throw new G("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,r);if(r){if(e.op=="add"){var o=e.path.split("/").length,i=n.split("/").length;if(o!==i+1&&o!==i)throw new G("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,r)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==n)throw new G("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,r)}else if(e.op==="move"||e.op==="copy"){var s={op:"_get",path:e.from,value:void 0},a=_f([s],r);if(a&&a.name==="OPERATION_PATH_UNRESOLVABLE")throw new G("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,r)}}}else throw new G("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,r)}function _f(e,t,r){try{if(!Array.isArray(e))throw new G("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)Xn(Q(t),Q(e),r||!0);else{r=r||Kn;for(var n=0;n<e.length;n++)r(e[n],n,t,void 0)}}catch(o){if(o instanceof G)return o;throw o}}function Pr(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var r=Array.isArray(e),n=Array.isArray(t),o,i,s;if(r&&n){if(i=e.length,i!=t.length)return!1;for(o=i;o--!==0;)if(!Pr(e[o],t[o]))return!1;return!0}if(r!=n)return!1;var a=Object.keys(e);if(i=a.length,i!==Object.keys(t).length)return!1;for(o=i;o--!==0;)if(!t.hasOwnProperty(a[o]))return!1;for(o=i;o--!==0;)if(s=a[o],!Pr(e[s],t[s]))return!1;return!0}return e!==e&&t!==t}var us={};H(us,{compare:()=>Fb,generate:()=>ss,observe:()=>Mb,unobserve:()=>Nb});var as=new WeakMap,Ob=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),Ub=function(){function e(t,r){this.callback=t,this.observer=r}return e}();function Rb(e){return as.get(e)}function Pb(e,t){return e.observers.get(t)}function Bb(e,t){e.observers.delete(t.callback)}function Nb(e,t){t.unobserve()}function Mb(e,t){var r=[],n,o=Rb(e);if(!o)o=new Ob(e),as.set(e,o);else{var i=Pb(o,t);n=i&&i.observer}if(n)return n;if(n={},o.value=Q(e),t){n.callback=t,n.next=null;var s=function(){ss(n)},a=function(){clearTimeout(n.next),n.next=setTimeout(s)};typeof window<"u"&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return n.patches=r,n.object=e,n.unobserve=function(){ss(n),clearTimeout(n.next),Bb(o,n),typeof window<"u"&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},o.observers.set(t,new Ub(t,n)),n}function ss(e,t){t===void 0&&(t=!1);var r=as.get(e.object);cs(r.value,e.object,e.patches,"",t),e.patches.length&&Xn(r.value,e.patches);var n=e.patches;return n.length>0&&(e.patches=[],e.callback&&e.callback(n)),n}function cs(e,t,r,n,o){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var i=Vn(t),s=Vn(e),a=!1,c=!1,u=s.length-1;u>=0;u--){var d=s[u],w=e[d];if(Hn(t,d)&&!(t[d]===void 0&&w!==void 0&&Array.isArray(t)===!1)){var x=t[d];typeof w=="object"&&w!=null&&typeof x=="object"&&x!=null&&Array.isArray(w)===Array.isArray(x)?cs(w,x,r,n+"/"+Re(d),o):w!==x&&(a=!0,o&&r.push({op:"test",path:n+"/"+Re(d),value:Q(w)}),r.push({op:"replace",path:n+"/"+Re(d),value:Q(x)}))}else Array.isArray(e)===Array.isArray(t)?(o&&r.push({op:"test",path:n+"/"+Re(d),value:Q(w)}),r.push({op:"remove",path:n+"/"+Re(d)}),c=!0):(o&&r.push({op:"test",path:n,value:e}),r.push({op:"replace",path:n,value:t}),a=!0)}if(!(!c&&i.length==s.length))for(var u=0;u<i.length;u++){var d=i[u];!Hn(e,d)&&t[d]!==void 0&&r.push({op:"add",path:n+"/"+Re(d),value:Q(t[d])})}}}function Fb(e,t,r){r===void 0&&(r=!1);var n=[];return cs(e,t,n,"",r),n}var Zn=Object.assign({},is,us,{JsonPatchError:Rr,deepClone:Q,escapePathComponent:Re,unescapePathComponent:Ur});var Cf=De(Ar(),1);var Tf=De(es(),1);var Lb=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(i=(o<3?s(i):o>3?s(t,r,i):s(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},ye,fs={anchor:!0,publish:!0,pin:!0,sync:$.PREFER_CACHE},jb={sync:$.PREFER_CACHE},Sf={anchor:!0,publish:!0,throwOnInvalidCommit:!0};function ls(e,t){if(typeof e?.schema=="string")try{P.fromString(e.schema)}catch{throw new Error("Schema must be a CommitID")}let r={controllers:e?.controllers,family:e?.family,schema:e?.schema?.toString(),tags:e?.tags};if(t)e?.deterministic||(r.unique=Fe((0,Tf.randomBytes)(12),"base64")),e?.forbidControllerChange&&(r.forbidControllerChange=!0);else{if(e?.deterministic!==void 0||e?.unique!==void 0)throw new Error("Cannot change 'deterministic' or 'unique' properties on existing Streams");if(e?.forbidControllerChange!==void 0)throw new Error("Cannot change 'forbidControllerChange' property on existing Streams")}return Object.keys(r).forEach(n=>r[n]===void 0&&delete r[n]),r}async function Af(e){if(!e.did)throw new Error("No DID provided");return e.did.authenticated||(await e.did.authenticate(),e.loggerProvider&&e.loggerProvider.getDiagnosticsLogger().imp(`Now authenticated as DID ${e.did.id}`)),e.did}async function ds(){throw new Error("Historical stream commits cannot be modified. Load the stream without specifying a commit to make updates.")}var He=ye=class extends Ue{constructor(){super(...arguments),this._isReadOnly=!1}get content(){return super.content}get metadata(){let{next:t,metadata:r}=this.state$.value;return(0,Cf.default)(t?.metadata??r)}get controllers(){return this.metadata.controllers}static async create(t,r,n,o={}){o={...fs,...o},!n?.deterministic&&o.syncTimeoutSeconds==null&&(o.syncTimeoutSeconds=0);let i=o.asDID?{did:o.asDID}:t,s=await ye.makeGenesis(i,r,n);return t.createStreamFromGenesis(ye.STREAM_TYPE_ID,s,o)}static async createFromGenesis(t,r,n={}){n={...fs,...n},r.header?.unique&&n.syncTimeoutSeconds==null&&(n.syncTimeoutSeconds=0);let o=r.data?await ye._signDagJWS(t,r):r;return t.createStreamFromGenesis(ye.STREAM_TYPE_ID,o,n)}static async deterministic(t,r,n={}){if(n={...fs,...n},r={...r,deterministic:!0},r.family==null&&r.tags==null)throw new Error("Family and/or tags are required when creating a deterministic tile document");let o=await ye.makeGenesis(t,null,r);return t.createStreamFromGenesis(ye.STREAM_TYPE_ID,o,n)}static async load(t,r,n={}){n={...jb,...n};let o=me.from(r);if(o.type!=ye.STREAM_TYPE_ID)throw new Error(`StreamID ${o.toString()} does not refer to a '${ye.STREAM_TYPE_NAME}' stream, but to a ${o.typeName}`);return t.loadStream(o,n)}async update(t,r,n={}){n={...Sf,...n};let o=n.asDID?{did:n.asDID}:this.api,i=await this.makeCommit(o,t,r),s=await this.api.applyCommit(this.id,i,n);this.state$.next(s.state)}async patch(t,r={}){r={...Sf,...r};let o={header:ls(this.metadata,!1),data:t,prev:this.tip,id:this.id.cid},i=await ye._signDagJWS(this.api,o),s=await this.api.applyCommit(this.id,i,r);this.state$.next(s.state)}makeReadOnly(){this.update=ds,this.patch=ds,this.sync=ds,this._isReadOnly=!0}get isReadOnly(){return this._isReadOnly}async makeCommit(t,r,n){let o=await this._makeRawCommit(r,n);return ye._signDagJWS(t,o)}async _makeRawCommit(t,r){r||(r={});let n=ls(r,!1);if(t==null&&(t=this.content),n.controllers){if(n.controllers.length!==1)throw new Error("Exactly one controller must be specified");if(!n.controllers[0])throw new Error("Controller cannot be updated to an undefined value.")}let o=Zn.compare(this.content,t),i=this.state.log[0];return{header:n,data:o,prev:this.tip,id:i.cid}}static async makeGenesis(t,r,n){if(n||(n={}),!n.controllers||n.controllers.length===0)if(t.did){let s=await Af(t);n.controllers=[s.hasParent?s.parent:s.id]}else throw new Error("No controllers specified");if(n.controllers?.length!==1)throw new Error("Exactly one controller must be specified");let o=ls(n,!0);if(n?.deterministic&&r)throw new Error("Initial content must be null when creating a deterministic Tile document");if(r==null){let s={header:o};return at(s),s}let i={data:r,header:o};return ye._signDagJWS(t,i)}static async _signDagJWS(t,r){return(await Af(t)).createDagJWS(r)}};He.STREAM_TYPE_NAME="tile";He.STREAM_TYPE_ID=0;He=ye=Lb([tt()],He);var $b="(?:%[0-9a-fA-F]{2})",kf=`(?:[a-zA-Z0-9._-]|${$b})`,zb="([a-z0-9]+)",qb=`((?:${kf}*:)*(${kf}+))`,If="[a-zA-Z0-9_.:%-]",Gb=`;${If}+=${If}*`,Jb=`((${Gb})*)`,Hb="(/[^#?]*)?",Vb="([?][^#]*)?",Wb="(#.*)?",Yb=new RegExp(`^did:${zb}:${qb}${Jb}${Hb}${Vb}${Wb}$`);function Of(e){if(e===""||!e)return null;let t=e.match(Yb);if(t){let r={did:`did:${t[1]}:${t[2]}`,method:t[1],id:t[2],didUrl:e};if(t[4]){let n=t[4].slice(1).split(";");r.params={};for(let o of n){let i=o.split("=");r.params[i[0]]=i[1]}}return t[6]&&(r.path=t[6]),t[7]&&(r.query=t[7].slice(1)),t[8]&&(r.fragment=t[8].slice(1)),r}return null}var Rf=De(Ar(),1),Kb=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(i=(o<3?s(i):o>3?s(t,r,i):s(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},xt,ps=()=>{throw new Error("Historical stream commits cannot be modified. Load the stream without specifying a commit to make updates.")},Uf={anchor:!1,publish:!0,pin:!0,sync:$.PREFER_CACHE},ms={anchor:!0,publish:!0,throwOnInvalidCommit:!0},Xb={sync:$.PREFER_CACHE},wt=xt=class extends Ue{constructor(){super(...arguments),this._isReadOnly=!1}get did(){return this.content}get metadata(){let{next:t,metadata:r}=this.state$.value;return(0,Rf.default)(t?.metadata??r)}get controllers(){return this.metadata.controllers}static async fromAccount(t,r,n={}){n={...Uf,...n};let o=Df(r),i=xt.makeGenesis(o);return xt.fromGenesis(t,i,n)}static async fromGenesis(t,r,n={}){return n={...Uf,...n},t.createStreamFromGenesis(xt.STREAM_TYPE_ID,r,n)}async setDid(t,r,n={}){n={...ms,...n};let o=typeof t=="string"?t.trim():t.id;if(Of(o)?.did!==o)throw new Error(`DID is not valid: '${o}'`);let s=await r.createLink(o);return this.setDidProof(s,n)}async setDidProof(t,r={}){r={...ms,...r};let n=this.makeCommit(t),o=await this.api.applyCommit(this.id,n,r);this.state$.next(o.state)}async clearDid(t,r={}){r={...ms,...r};let n=await t.createLink("");return this.setDidProof(n,r)}static async load(t,r,n={}){n={...Xb,...n};let o=me.from(r);if(o.type!=xt.STREAM_TYPE_ID)throw new Error(`StreamID ${o.toString()} does not refer to a '${xt.STREAM_TYPE_NAME}' stream, but to a ${o.typeName}`);return t.loadStream(o,n)}static makeGenesis(t){return t.chainId.namespace==="eip155"&&(t.address=t.address.toLowerCase()),{header:{controllers:[`${t.address}@${t.chainId.toString()}`],family:`caip10-${t.chainId.toString()}`}}}makeCommit(t){return{data:t,prev:this.tip,id:this.id.cid}}makeReadOnly(){this.setDidProof=ps,this.setDid=ps,this.sync=ps,this._isReadOnly=!0}get isReadOnly(){return this._isReadOnly}};wt.STREAM_TYPE_NAME="caip10-link";wt.STREAM_TYPE_ID=1;wt=xt=Kb([tt()],wt);Me();nt();var hl=De(pl(),1),Gy=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(i=(o<3?s(i):o>3?s(t,r,i):s(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},Pe,Jy={sync:$.PREFER_CACHE};async function ml(e){if(e.did==null)throw new Error("No DID provided");e.did.authenticated||(await e.did.authenticate(),e.loggerProvider&&e.loggerProvider.getDiagnosticsLogger().imp(`Now authenticated as DID ${e.did.id}`))}async function Hy(){throw new Error("Historical stream commits cannot be modified. Load the stream without specifying a commit to make updates.")}var rt=Pe=class extends Ue{constructor(){super(...arguments),this._isReadOnly=!1}get content(){return super.content}get metadata(){return{controller:this.state$.value.metadata.controllers[0],model:Pe.MODEL}}static async create(t,r,n){Pe.assertComplete(r);let o={publish:!0,anchor:!0,pin:!0,sync:$.NEVER_SYNC,throwOnInvalidCommit:!0},i=await Pe._makeGenesis(t,r,n);return await t.createStreamFromGenesis(Pe.STREAM_TYPE_ID,i,o)}static assertComplete(t,r){if(!t.name)throw r?new Error(`Model with StreamID ${r.toString()} is missing a 'name' field`):new Error("Model is missing a 'name' field");if(!t.schema)throw r?new Error(`Model ${t.name} (${r.toString()}) is missing a 'schema' field`):new Error(`Model ${t.name} is missing a 'schema' field`);if(!t.accountRelation)throw r?new Error(`Model ${t.name} (${r.toString()}) is missing a 'accountRelation' field`):new Error(`Model ${t.name} is missing a 'accountRelation' field`)}static async load(t,r,n={}){n={...Jy,...n};let o=me.from(r);if(o.type!=Pe.STREAM_TYPE_ID)throw new Error(`StreamID ${o.toString()} does not refer to a '${Pe.STREAM_TYPE_NAME}' stream, but to a ${o.typeName}`);return await t.loadStream(o,n)}static async _makeGenesis(t,r,n){let o=await this._makeRawGenesis(t,r,n);return Pe._signDagJWS(t,o)}static async _makeRawGenesis(t,r,n){if(r==null)throw new Error("Genesis content cannot be null");if(!n||!n.controller)if(t.did)await ml(t),n={controller:t.did.hasParent?t.did.parent:t.did.id};else throw new Error("No controller specified");let o={controllers:[n.controller],model:Pe.MODEL.bytes};return{data:r,header:o}}makeReadOnly(){this.sync=Hy,this._isReadOnly=!0}get isReadOnly(){return this._isReadOnly}static async _signDagJWS(t,r){return await ml(t),t.did.createDagJWS(r)}};rt.STREAM_TYPE_NAME="model";rt.STREAM_TYPE_ID=2;rt.MODEL=function(){let e=at("model-v1"),t=hl.default.encode(e,"identity"),r=Ne(sn,t),n=g.createV1(sn,r);return new E("UNLOADABLE",n)}();rt=Pe=Gy([tt()],rt);var xl=De(es(),1);var Vy=function(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(i=(o<3?s(i):o>3?s(t,r,i):s(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},ke,Wy={anchor:!0,publish:!0,pin:!0,sync:$.NEVER_SYNC,syncTimeoutSeconds:0},Yy={anchor:!1,publish:!1,pin:!0,sync:$.PREFER_CACHE},Ky={sync:$.PREFER_CACHE},bl={anchor:!0,publish:!0,throwOnInvalidCommit:!0};async function yl(e){if(e.did==null)throw new Error("No DID provided");e.did.authenticated||(await e.did.authenticate(),e.loggerProvider&&e.loggerProvider.getDiagnosticsLogger().imp(`Now authenticated as DID ${e.did.id}`))}async function xs(){throw new Error("Historical stream commits cannot be modified. Load the stream without specifying a commit to make updates.")}var vt=ke=class extends Ue{constructor(){super(...arguments),this._isReadOnly=!1}get content(){return super.content}get metadata(){let t=this.state$.value.metadata;return{controller:t.controllers[0],model:t.model}}static async create(t,r,n,o={}){o={...Wy,...o};let i=o.asDID?{did:o.asDID}:t,s=await ke._makeGenesis(i,r,n);return t.createStreamFromGenesis(ke.STREAM_TYPE_ID,s,o)}static async single(t,r,n={}){n={...Yy,...n};let o=n.asDID?{did:n.asDID}:t;r={...r,deterministic:!0};let i=await ke._makeGenesis(o,null,r);return t.createStreamFromGenesis(ke.STREAM_TYPE_ID,i,n)}static async load(t,r,n={}){n={...Ky,...n};let o=me.from(r);if(o.type!=ke.STREAM_TYPE_ID)throw new Error(`StreamID ${o.toString()} does not refer to a '${ke.STREAM_TYPE_NAME}' stream, but to a ${o.typeName}`);return t.loadStream(o,n)}async replace(t,r={}){r={...bl,...r};let n=r.asDID?{did:r.asDID}:this.api,o=await this._makeCommit(n,t),i=await this.api.applyCommit(this.id,o,r);this.state$.next(i.state)}async patch(t,r={}){r={...bl,...r};let n={data:t,prev:this.tip,id:this.id.cid},o=await ke._signDagJWS(this.api,n),i=await this.api.applyCommit(this.id,o,r);this.state$.next(i.state)}makeReadOnly(){this.replace=xs,this.patch=xs,this.sync=xs,this._isReadOnly=!0}get isReadOnly(){return this._isReadOnly}_makeCommit(t,r){let n=this._makeRawCommit(r);return ke._signDagJWS(t,n)}_makeRawCommit(t){return{data:Zn.compare(this.content,t||{}),prev:this.tip,id:this.state.log[0].cid}}static async _makeGenesis(t,r,n){let o=await this._makeRawGenesis(t,r,n);return n.deterministic?(at(o),o):ke._signDagJWS(t,o)}static async _makeRawGenesis(t,r,n){if(!n.model)throw new Error("Must specify a 'model' when creating a ModelInstanceDocument");let o=n.controller;if(!o)if(t.did)await yl(t),o=t.did.hasParent?t.did.parent:t.did.id;else throw new Error("No controller specified");let i={controllers:[o],model:n.model.bytes};return n.deterministic||(i.unique=(0,xl.randomBytes)(12)),{data:r,header:i}}static async _signDagJWS(t,r){return await yl(t),t.did.createDagJWS(r)}};vt.STREAM_TYPE_NAME="MID";vt.STREAM_TYPE_ID=3;vt=ke=Vy([tt()],vt);var ro=class{constructor(t){this._apiUrl=t}async add(t,r){let n={};r&&(n.force=!0);let o=new URL(`./pins/${t}`,this._apiUrl);await Z(o,{method:"post",body:n})}async rm(t,r){let n=new URL(`./pins/${t}`,this._apiUrl);await Z(n,{method:"delete",body:{opts:r}})}async ls(t){let r=new URL("./pins",this._apiUrl);t&&(r=new URL(`./pins/${t.toString()}`,this._apiUrl));let n=await Z(r),{pinnedStreamIds:o}=n;return{[Symbol.asyncIterator](){let i=0;return{next(){return i===o.length?Promise.resolve({value:null,done:!0}):Promise.resolve({value:o[i++],done:!1})}}}}}};var no=class{constructor(t){this._fetchJson=Z,this._collectionURL=new URL("./collection",t),this._countURL=new URL("./collection/count",t)}async count(t){return(await this._fetchJson(this._countURL,{method:"POST",body:mi(t)})).count}async query(t){let r=await this._fetchJson(this._collectionURL,{method:"POST",body:mi(t)});return{edges:r.edges.map(o=>({cursor:o.cursor,node:N.deserializeState(o.node)})),pageInfo:r.pageInfo}}};var oo=class{constructor(t,r){this._apiUrl=t,this._getDidFn=r,this._fetchJson=Z,this.modelsPath="./admin/models",this.getCodePath="./admin/getCode"}getCodeUrl(){return new URL(this.getCodePath,this._apiUrl)}getModelsUrl(){return new URL(this.modelsPath,this._apiUrl)}async buildJWS(t,r,n){let o=n?{models:n.map(s=>s.toString())}:void 0,i=await t.createJWS({code:r,requestPath:this.getModelsUrl().pathname,requestBody:o});return`${i.signatures[0].protected}.${i.payload}.${i.signatures[0].signature}`}async generateCode(){return(await this._fetchJson(this.getCodeUrl())).code}async startIndexingModels(t){let r=await this.generateCode();await this._fetchJson(this.getModelsUrl(),{method:"post",body:{jws:await this.buildJWS(this._getDidFn(),r,t)}})}async getIndexedModels(){let t=await this.generateCode();return(await this._fetchJson(this.getModelsUrl(),{headers:{Authorization:`Basic ${await this.buildJWS(this._getDidFn(),t)}`}})).models.map(n=>E.fromString(n))}async stopIndexingModels(t){let r=await this.generateCode();await this._fetchJson(this.getModelsUrl(),{method:"delete",body:{jws:await this.buildJWS(this._getDidFn(),r,t)}})}};var Xy="/api/v0/",Zy="http://localhost:7007",Qy={syncInterval:5e3},e0={anchor:!0,publish:!0,sync:$.PREFER_CACHE},t0={anchor:!0,publish:!0,sync:$.PREFER_CACHE},wl={sync:$.PREFER_CACHE},io=class{constructor(t=Zy,r={}){this._config={...Qy,...r},this._apiUrl=new URL(Xy,t),this.context={api:this},this.pin=new ro(this._apiUrl),this.index=new no(this._apiUrl);let n=(()=>this.did).bind(this);this.admin=new oo(this._apiUrl,n),this._streamConstructors={[wt.STREAM_TYPE_ID]:wt,[rt.STREAM_TYPE_ID]:rt,[vt.STREAM_TYPE_ID]:vt,[He.STREAM_TYPE_ID]:He}}get did(){return this.context.did}set did(t){this.context.did=t}async createStreamFromGenesis(t,r,n={}){n={...t0,...n};let o=await se.createFromGenesis(this._apiUrl,t,r,n,this._config.syncInterval);return this.buildStreamFromDocument(o)}async loadStream(t,r={}){r={...wl,...r};let n=me.from(t),o=await se.load(n,this._apiUrl,this._config.syncInterval,r);return this.buildStreamFromDocument(o)}async multiQuery(t,r){let n=t.map(s=>({...s,streamId:typeof s.streamId=="string"?s.streamId:s.streamId.toString()})),o=new URL("./multiqueries",this._apiUrl),i=await Z(o,{method:"post",body:{queries:n,timeout:r}});return Object.entries(i).reduce((s,a)=>{let[c,u]=a,d=N.deserializeState(u),w=new se(d,this._apiUrl,this._config.syncInterval);return s[c]=this.buildStreamFromDocument(w),s},{})}loadStreamCommits(t){let r=pi(t);return se.loadStreamCommits(r,this._apiUrl)}async applyCommit(t,r,n={}){n={...e0,...n};let o=pi(t),i=await se.applyCommit(this._apiUrl,o,r,n,this._config.syncInterval);return this.buildStreamFromDocument(i)}async requestAnchor(t,r={}){r={...wl,...r};let{anchorStatus:n}=await Z(`${this._apiUrl}/streams/${t.toString()}/anchor`,{method:"post",body:{opts:r}});return n}addStreamHandler(t){this._streamConstructors[t.name]=t.stream_constructor}buildStreamFromState(t){let r=new se(t,this._apiUrl,this._config.syncInterval);return this.buildStreamFromDocument(r)}buildStreamFromDocument(t){let r=t.state.type,n=this._streamConstructors[r];if(!n)throw new Error(`Failed to find constructor for stream ${r}`);return new n(t,this.context)}async setDID(t){this.context.did=t}async getSupportedChains(){if(this._supportedChains)return this._supportedChains;let{supportedChains:t}=await Z(this._apiUrl+"/node/chains");return this._supportedChains=t,t}async close(){}};return Lr(r0);})();

const Cacao = test.Cacao;
const DIDSession = test.DIDSession;
const CeramicClient = test.CeramicClient;
const TileDocument = test.TileDocument;

const personalSign = async () => {

    const sigShare = await LitActions.ethPersonalSignMessageEcdsa({
        message: toSign,
        publicKey,
        sigName: "sig1",
    });

    console.log("sigShare =>", sigShare);
    
};

const getDIDSession = async () => {
    const ceramic = new CeramicClient("https://node1.orbis.club/");

    const threeMonths = 60 * 60 * 24 * 90;
    const authMethod = (async () => {return Cacao.fromSiweMessage(siweMessage)});

    let did;

    // start
    var cacao = Cacao.fromSiweMessage(siweMessage);


    const postSchemaCommit = "k1dpgaqe3i64kjuyet4w0zyaqwamf9wrp1jim19y27veqkppo34yghivt2pag4wxp0fv2yl4hedynpfuynp2wvd8s7ctabea6lx732xrr8b0cgqauwlh0vwg6";

    // create a post
    // let doc = await test.TileDocument.create(
    //     ceramic,
    //     /** Content of the post */
    //     "HELLO WORLD!",
    //     /** Metadata */
    //     {
    //         family: "orbis",
    //         controllers: [session.id],
    //         tags: ["orbis", "post"],
    //         schema: postSchemaCommit
    //     },
    // );

    // console.log("doc =>", doc);


}

// triggers
if (functionName === 'personalSign()') {
    console.log("...running personalSign");
    personalSign();
}

if (functionName === 'getDIDSession()') {
    console.log("...running getDIDSession");
    getDIDSession();
}
            

